This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.github/
  ISSUE_TEMPLATE/
    content-update.md
  workflows/
    ci.yml
  PULL_REQUEST_TEMPLATE.md
cold-dawn-85a2/
  .vscode/
    settings.json
  public/
    index.html
  src/
    index.ts
  test/
    index.spec.ts
    tsconfig.json
  .editorconfig
  .gitignore
  .prettierrc
  package.json
  tsconfig.json
  vitest.config.mts
  wrangler.jsonc
docs/
  assets/
    footer.png
    home-hero.png
    lighthouse-latest.png
    plan-visit.png
  decisions/
    ADR-TEMPLATE.md
  phase-0/
    content-inventory.md
    gaps-register.md
    mvp-definition.md
    README.md
    risk-register.md
    sitemap.md
    source-of-truth.yml
    working-agreement.md
  deploy.md
  ui-handoff.md
  ui-reliability.md
web/
  .vscode/
    extensions.json
    launch.json
  public/
    bulletins/
      2025-12-13.pdf
      2025-12-20.pdf
      2026-01-03.pdf
    _headers
    .assetsignore
  src/
    assets/
      photos/
        bridge-dusk.jpg
        first-springfield-exterior.png
    components/
      content/
        ContentCard.astro
      global/
        Footer.astro
        Header.astro
      media/
        YouTubeEmbed.astro
      sections/
        CardGrid.astro
        EventList.astro
        Hero.astro
        HeroBanner.astro
        RecurringActivities.astro
        SermonHighlight.astro
      ui/
        Banner.astro
        Button.astro
        ButtonLink.astro
        Card.astro
        CardGrid.astro
        Hero.astro
        MapEmbed.astro
        Schedule.astro
        YouTubeEmbed.astro
      Footer.astro
      Header.astro
      PlaceholderPage.astro
      Welcome.astro
    content/
      bulletins/
        2025-12-13.md
        2025-12-20.md
        2026-01-03.md
      events/
        sabbath-service.md
      ministries/
        adult-sabbath-school.md
        adventurers.md
        bible-study.md
        board-meeting.md
        children.md
        community-meal-spaghetti.md
        mens-ministry.md
        pathfinders.md
        womens-ministry.md
      resources/
        2025/
          12/
            16/
              welcome-packet.md
    data/
      activities.ts
      site-links.json
      site.ts
      videos.json
      week-schedule.json
    layouts/
      BaseLayout.astro
      Layout.astro
    lib/
      links.ts
    pages/
      connect/
        about/
          index.astro
        contact/
          index.astro
        plan-a-visit/
          index.astro
        prayer/
          index.astro
        team/
          index.astro
        worship-with-us/
          index.astro
        index.astro
      events/
        [id].astro
        index.astro
      give/
        index.astro
      join/
        index.astro
      media/
        live/
          index.astro
        videos/
          index.astro
        index.astro
      ministries/
        [id].astro
        index.astro
      privacy/
        index.astro
      resources/
        bulletins/
          index.astro
        forms/
          index.astro
        [...id].astro
        index.astro
      search/
        index.astro
      serve/
        index.astro
      404.astro
      components.astro
      index.astro
      robots.txt.ts
    styles/
      a11y.css
      global.css
      tokens.css
    content.config.ts
  test-results/
    .last-run 2.json
    .last-run.json
  tests/
    e2e/
      content-collections.spec.ts
      mobile.smoke.spec.ts
      phase-5-media-portals.spec.ts
      phase-6-search-and-analytics.spec.ts
      phase-7-a11y.spec.ts
      phase-7-seo.spec.ts
      phase-7-sitefiles.spec.ts
      smoke.spec.ts
  .env.example
  .gitignore
  astro.config.mjs
  hast-util-to-html-8.0.4.tgz
  hast-util-to-html-9.0.5.tgz
  lighthouserc.cjs
  linkinator.config.json
  package.json
  playwright.config.ts
  README.md
  tsconfig.json
  wrangler.jsonc
.editorconfig
.gitignore
.nvmrc
.repomixignore
CODE_OF_CONDUCT.md
CONTRIBUTING.md
LICENSE
lighthouserc-ci.cjs
package.json
README.md
SECURITY.md
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".github/ISSUE_TEMPLATE/content-update.md">
---
name: Content update
about: Update copy, dates, service times, or links
---

## What needs updating?

## Where on the site?

## Source of truth
(Who confirmed this information?)

## Deadline
</file>

<file path=".github/workflows/ci.yml">
name: CI

on:
  pull_request:
  push:
    branches: ["main", "master"]

jobs:
  web:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: web

    env:
      # Ensures canonical URLs + sitemap/robots generation are deterministic in CI
      PUBLIC_SITE_URL: http://127.0.0.1:4321

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: npm
          cache-dependency-path: web/package-lock.json

      - name: Install dependencies
        run: npm ci

      - name: Typecheck
        run: npm run check

      - name: Build
        run: npm run build

      - name: Install Playwright browsers
        run: npx playwright install --with-deps

      - name: E2E tests
        run: npm run test:e2e:ci

      - name: Internal link check
        run: npm run test:links:ci

      - name: Lighthouse CI
        id: lighthouse
        uses: treosh/lighthouse-ci-action@v12
        with:
          configPath: ./lighthouserc-ci.cjs
          temporaryPublicStorage: true
          uploadArtifacts: false

      - name: Build Lighthouse summary
        if: github.event_name == "pull_request"
        id: lhci-summary
        uses: actions/github-script@v8
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const core = require("@actions/core");
            const manifest = JSON.parse(process.env.MANIFEST_JSON || "[]");
            const entry = manifest[0] || {};
            const summary = entry.summary || {};
            const metricLabels = {
              performance: "Performance",
              accessibility: "Accessibility",
              "best-practices": "Best Practices",
              seo: "SEO",
              pwa: "PWA",
            };
            const metrics = Object.keys(metricLabels)
              .filter((key) => summary[key] !== undefined)
              .map((key) => `| ${metricLabels[key]} | ${Math.round(summary[key] * 100)}% |`);
            const table =
              metrics.length > 0
                ? ["| Metric | Score |", "| --- | --- |", ...metrics].join("\n")
                : "No Lighthouse scores available.";
            const links = JSON.parse(process.env.LINKS_JSON || "{}");
            const reportLink = Object.values(links)[0];
            const body = [
              "## Lighthouse CI results",
              table,
              reportLink
                ? `Temporary public report: [view it here](${reportLink})`
                : "Temporary public report not available.",
              "Artifacts remain in the `lighthouseci` artifact bundle for this run.",
            ].join("\n\n");
            core.setOutput("body", body);
        env:
          MANIFEST_JSON: ${{ steps.lighthouse.outputs.manifest }}
          LINKS_JSON: ${{ steps.lighthouse.outputs.links || "{}" }}

      - name: Comment Lighthouse results
        if: github.event_name == "pull_request"
        uses: peter-evans/create-or-update-comment@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          issue-number: ${{ github.event.pull_request.number }}
          body: ${{ steps.lhci-summary.outputs.body }}
          tag: lighthouse-ci

      - name: Upload Lighthouse artifacts
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: lighthouseci
          path: web/.lighthouseci

      - name: Upload Playwright report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: playwright-report
          path: web/playwright-report
</file>

<file path=".github/PULL_REQUEST_TEMPLATE.md">
## What changed?

- 

## Why?

- 

## How to verify

- [ ] I verified links work
- [ ] I checked for obvious copy/typos
- [ ] I confirmed dates/times are correct

## Screenshots (if applicable)
</file>

<file path="cold-dawn-85a2/.vscode/settings.json">
{
	"files.associations": {
		"wrangler.json": "jsonc"
	}
}
</file>

<file path="cold-dawn-85a2/public/index.html">
<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Hello, World!</title>
	</head>
	<body>
		<h1 id="heading"></h1>
		<p>This page comes from a static asset stored at `public/index.html` as configured in `wrangler.jsonc`.</p>
		<button id="button" type="button">Fetch a random UUID</button>
		<output id="random" for="button"></output>
		<script>
			fetch('/message')
				.then((resp) => resp.text())
				.then((text) => {
					const h1 = document.getElementById('heading');
					h1.textContent = text;
				});

			const button = document.getElementById("button");
			button.addEventListener("click", () => {
				fetch('/random')
					.then((resp) => resp.text())
					.then((text) => {
						const random = document.getElementById('random');
						random.textContent = text;
					});
			});
		</script>
	</body>
</html>
</file>

<file path="cold-dawn-85a2/src/index.ts">
/**
 * Welcome to Cloudflare Workers! This is your first worker.
 *
 * - Run `npm run dev` in your terminal to start a development server
 * - Open a browser tab at http://localhost:8787/ to see your worker in action
 * - Run `npm run deploy` to publish your worker
 *
 * Bind resources to your worker in `wrangler.jsonc`. After adding bindings, a type definition for the
 * `Env` object can be regenerated with `npm run cf-typegen`.
 *
 * Learn more at https://developers.cloudflare.com/workers/
 */

export default {
	async fetch(request, env, ctx): Promise<Response> {
		const url = new URL(request.url);
		switch (url.pathname) {
			case '/message':
				return new Response('Hello, World!');
			case '/random':
				return new Response(crypto.randomUUID());
			default:
				return new Response('Not Found', { status: 404 });
		}
	},
} satisfies ExportedHandler<Env>;
</file>

<file path="cold-dawn-85a2/test/index.spec.ts">
import { env, createExecutionContext, waitOnExecutionContext, SELF } from 'cloudflare:test';
import { describe, it, expect } from 'vitest';
import worker from '../src';

describe('Hello World user worker', () => {
	describe('request for /message', () => {
		it('/ responds with "Hello, World!" (unit style)', async () => {
			const request = new Request<unknown, IncomingRequestCfProperties>('http://example.com/message');
			// Create an empty context to pass to `worker.fetch()`.
			const ctx = createExecutionContext();
			const response = await worker.fetch(request, env, ctx);
			// Wait for all `Promise`s passed to `ctx.waitUntil()` to settle before running test assertions
			await waitOnExecutionContext(ctx);
			expect(await response.text()).toMatchInlineSnapshot(`"Hello, World!"`);
		});

		it('responds with "Hello, World!" (integration style)', async () => {
			const request = new Request('http://example.com/message');
			const response = await SELF.fetch(request);
			expect(await response.text()).toMatchInlineSnapshot(`"Hello, World!"`);
		});
	});

	describe('request for /random', () => {
		it('/ responds with a random UUID (unit style)', async () => {
			const request = new Request<unknown, IncomingRequestCfProperties>('http://example.com/random');
			// Create an empty context to pass to `worker.fetch()`.
			const ctx = createExecutionContext();
			const response = await worker.fetch(request, env, ctx);
			// Wait for all `Promise`s passed to `ctx.waitUntil()` to settle before running test assertions
			await waitOnExecutionContext(ctx);
			expect(await response.text()).toMatch(/[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}/);
		});

		it('responds with a random UUID (integration style)', async () => {
			const request = new Request('http://example.com/random');
			const response = await SELF.fetch(request);
			expect(await response.text()).toMatch(/[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}/);
		});
	});
});
</file>

<file path="cold-dawn-85a2/test/tsconfig.json">
{
	"extends": "../tsconfig.json",
	"compilerOptions": {
		"types": ["@cloudflare/vitest-pool-workers"]
	},
	"include": ["./**/*.ts", "../worker-configuration.d.ts"],
	"exclude": []
}
</file>

<file path="cold-dawn-85a2/.editorconfig">
# http://editorconfig.org
root = true

[*]
indent_style = tab
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.yml]
indent_style = space
</file>

<file path="cold-dawn-85a2/.gitignore">
# Logs

logs
_.log
npm-debug.log_
yarn-debug.log*
yarn-error.log*
lerna-debug.log*
.pnpm-debug.log*

# Diagnostic reports (https://nodejs.org/api/report.html)

report.[0-9]_.[0-9]_.[0-9]_.[0-9]_.json

# Runtime data

pids
_.pid
_.seed
\*.pid.lock

# Directory for instrumented libs generated by jscoverage/JSCover

lib-cov

# Coverage directory used by tools like istanbul

coverage
\*.lcov

# nyc test coverage

.nyc_output

# Grunt intermediate storage (https://gruntjs.com/creating-plugins#storing-task-files)

.grunt

# Bower dependency directory (https://bower.io/)

bower_components

# node-waf configuration

.lock-wscript

# Compiled binary addons (https://nodejs.org/api/addons.html)

build/Release

# Dependency directories

node_modules/
jspm_packages/

# Snowpack dependency directory (https://snowpack.dev/)

web_modules/

# TypeScript cache

\*.tsbuildinfo

# Optional npm cache directory

.npm

# Optional eslint cache

.eslintcache

# Optional stylelint cache

.stylelintcache

# Microbundle cache

.rpt2_cache/
.rts2_cache_cjs/
.rts2_cache_es/
.rts2_cache_umd/

# Optional REPL history

.node_repl_history

# Output of 'npm pack'

\*.tgz

# Yarn Integrity file

.yarn-integrity

# parcel-bundler cache (https://parceljs.org/)

.cache
.parcel-cache

# Next.js build output

.next
out

# Nuxt.js build / generate output

.nuxt
dist

# Gatsby files

.cache/

# Comment in the public line in if your project uses Gatsby and not Next.js

# https://nextjs.org/blog/next-9-1#public-directory-support

# public

# vuepress build output

.vuepress/dist

# vuepress v2.x temp and cache directory

.temp
.cache

# Docusaurus cache and generated files

.docusaurus

# Serverless directories

.serverless/

# FuseBox cache

.fusebox/

# DynamoDB Local files

.dynamodb/

# TernJS port file

.tern-port

# Stores VSCode versions used for testing VSCode extensions

.vscode-test

# yarn v2

.yarn/cache
.yarn/unplugged
.yarn/build-state.yml
.yarn/install-state.gz
.pnp.\*

# wrangler project

.dev.vars*
!.dev.vars.example
.env*
!.env.example
.wrangler/
</file>

<file path="cold-dawn-85a2/.prettierrc">
{
	"printWidth": 140,
	"singleQuote": true,
	"semi": true,
	"useTabs": true
}
</file>

<file path="cold-dawn-85a2/package.json">
{
	"name": "cold-dawn-85a2",
	"version": "0.0.0",
	"private": true,
	"scripts": {
		"deploy": "wrangler deploy",
		"dev": "wrangler dev",
		"start": "wrangler dev",
		"test": "vitest",
		"cf-typegen": "wrangler types"
	},
	"devDependencies": {
		"@cloudflare/vitest-pool-workers": "^0.8.19",
		"typescript": "^5.5.2",
		"vitest": "~3.2.0",
		"wrangler": "4.55.0"
	}
}
</file>

<file path="cold-dawn-85a2/tsconfig.json">
{
	"compilerOptions": {
		/* Visit https://aka.ms/tsconfig.json to read more about this file */

    /* Set the JavaScript language version for emitted JavaScript and include compatible library declarations. */
		"target": "es2024",
    /* Specify a set of bundled library declaration files that describe the target runtime environment. */
		"lib": ["es2024"],
    /* Specify what JSX code is generated. */
		"jsx": "react-jsx",

    /* Specify what module code is generated. */
		"module": "es2022",
    /* Specify how TypeScript looks up a file from a given module specifier. */
		"moduleResolution": "Bundler",
    /* Enable importing .json files */
		"resolveJsonModule": true,

    /* Allow JavaScript files to be a part of your program. Use the `checkJS` option to get errors from these files. */
		"allowJs": true,
    /* Enable error reporting in type-checked JavaScript files. */
		"checkJs": false,

    /* Disable emitting files from a compilation. */
		"noEmit": true,

    /* Ensure that each file can be safely transpiled without relying on other imports. */
		"isolatedModules": true,
    /* Allow 'import x from y' when a module doesn't have a default export. */
		"allowSyntheticDefaultImports": true,
    /* Ensure that casing is correct in imports. */
		"forceConsistentCasingInFileNames": true,

    /* Enable all strict type-checking options. */
		"strict": true,

    /* Skip type checking all .d.ts files. */
		"skipLibCheck": true,
		"types": [
			"./worker-configuration.d.ts"
		]
	},
	"exclude": ["test"],
	"include": ["worker-configuration.d.ts", "src/**/*.ts"]
}
</file>

<file path="cold-dawn-85a2/vitest.config.mts">
import { defineWorkersConfig } from '@cloudflare/vitest-pool-workers/config';

export default defineWorkersConfig({
	test: {
		poolOptions: {
			workers: {
				wrangler: { configPath: './wrangler.jsonc' },
			},
		},
	},
});
</file>

<file path="cold-dawn-85a2/wrangler.jsonc">
/**
 * For more details on how to configure Wrangler, refer to:
 * https://developers.cloudflare.com/workers/wrangler/configuration/
 */
{
	"$schema": "node_modules/wrangler/config-schema.json",
	"name": "cold-dawn-85a2",
	"main": "src/index.ts",
	"compatibility_date": "2025-12-16",
	"compatibility_flags": [
		"global_fetch_strictly_public"
	],
	"assets": {
		// The path to the directory containing the `index.html` file to be served at `/`
		"directory": "./public"
	},
	"observability": {
		"enabled": true
	}
	/**
	 * Smart Placement
	 * https://developers.cloudflare.com/workers/configuration/smart-placement/#smart-placement
	 */
	// "placement": {  "mode": "smart" }
	/**
	 * Bindings
	 * Bindings allow your Worker to interact with resources on the Cloudflare Developer Platform, including
	 * databases, object storage, AI inference, real-time communication and more.
	 * https://developers.cloudflare.com/workers/runtime-apis/bindings/
	 */
	/**
	 * Environment Variables
	 * https://developers.cloudflare.com/workers/wrangler/configuration/#environment-variables
	 * Note: Use secrets to store sensitive data.
	 * https://developers.cloudflare.com/workers/configuration/secrets/
	 */
	// "vars": {  "MY_VARIABLE": "production_value" }
	/**
	 * Service Bindings (communicate between multiple Workers)
	 * https://developers.cloudflare.com/workers/wrangler/configuration/#service-bindings
	 */
	// "services": [  {   "binding": "MY_SERVICE",   "service": "my-service"  } ]
}
</file>

<file path="docs/decisions/ADR-TEMPLATE.md">
# ADR: <Title>

## Status
Proposed | Accepted | Superseded

## Context
What problem are we solving?

## Decision
What did we decide?

## Consequences
What tradeoffs does this create?

## Date
YYYY-MM-DD
</file>

<file path="docs/phase-0/content-inventory.md">
# Content + Asset Inventory

## Brand assets
- [ ] Logo (full color)
- [ ] Logo (white)
- [ ] Logo (black)
- [ ] Favicon / square mark

## Photography
Minimum goal: 10–20 photos
- [ ] Exterior building shot
- [ ] Sanctuary/worship
- [ ] Small group / fellowship
- [ ] Pastoral/leadership portrait (if published)
- [ ] Ministry activity photos

## Bulletins
- [ ] Current bulletin PDF
- [ ] Archive PDFs (start date: TBD)

### Bulletin naming rule (proposal)
- `YYYY-MM-DD-bulletin.pdf`

## Ministries
Starter set (TBD):
- [ ] Youth
- [ ] Women
- [ ] Men
- [ ] Kids
- [ ] Music

## Events
- [ ] List next 5–10 events with title, date/time, short description, location

## Publishing permissions
- [ ] Confirm whether we can publish photos with children/faces
- [ ] Confirm if we need written consent for close-ups
</file>

<file path="docs/phase-0/gaps-register.md">
# Gaps Register

| Gap | Why it matters | Owner | Due date | Status | Where it will be stored |
|---|---|---:|---:|---|---|
| Public contact email | Contact + footer consistency | TBD | TBD | Open | source-of-truth.yml |
| Leadership list | Team page + ministry contacts | TBD | TBD | Open | source-of-truth.yml / content files |
| Bulletin archive start date | Archive page + naming rules | TBD | TBD | Open | content-inventory.md |
| Official social links | Header/footer + trust | TBD | TBD | Open | site-links.json |
| Language policy | Site IA + content workflow | TBD | TBD | Open | working-agreement.md |
| Photo permissions policy | Privacy + trust | TBD | TBD | Open | content-inventory.md |
| Analytics choice | Reporting + privacy posture | TBD | TBD | Open | ADR |
</file>

<file path="docs/phase-0/mvp-definition.md">
# MVP Definition

## Primary visitor goals
1. Find service times in under 10 seconds.
2. Get directions and contact the church.
3. Watch live or access the latest videos.
4. See upcoming events.
5. Find the giving link.
6. Submit a prayer request or contact form (external portal acceptable).

## MVP pages
- Home
- Plan a Visit
- Worship With Us
- About
- Contact
- Live
- Videos
- Events (hub + detail)
- Ministries (hub + detail)
- Bulletins (current + archive)

## MVP portals (external)
- Giving
- Prayer request form
- Contact form (if separate)

## MVP acceptance criteria (high-level)
- Home page shows service times + address + Watch Live + Give.
- Contact page includes at least one working method (email or phone) and directions.
- Live page includes embedded YouTube (when available) and a fallback link to the channel.
- Every portal link is tested on mobile.

## Out of scope for MVP
- Member login
- Payment processing on-site
- Custom database/admin panel
- Custom admin UI
</file>

<file path="docs/phase-0/README.md">
# Phase 0 (Initiation)

This folder contains the documents that unblock Phase 1.

**Exit criteria:**
- MVP scope + sitemap approved
- gaps assigned with owners + due dates
- source-of-truth file created
- domain approach decided
- content inventory plan created
- working agreement captured
</file>

<file path="docs/phase-0/risk-register.md">
# Risk Register

| Risk | Likelihood | Impact | Mitigation | Owner |
|---|---|---|---|---|
| Missing critical content (email, photos, bulletins) | Med | High | Assign owners + due dates in Gaps Register | TBD |
| Live embed fails on mobile networks | Med | High | Always include fallback link + “If stream doesn’t load” copy | TBD |
| Form spam | Med | Med | Start with Google Forms; consider Turnstile later for custom endpoint | TBD |
| Volunteer bandwidth drops | High | Med | Keep MVP small; defer nice-to-haves to backlog | TBD |
| Portal URLs change | Med | Med | Centralize links in a single config and re-check monthly | TBD |
| Wrong service times posted | Low | High | Source-of-truth file + explicit approver for schedule changes | TBD |
| Copyright/media issues | Low | High | Use only approved photos/music thumbnails; document source/permission | TBD |
</file>

<file path="docs/phase-0/sitemap.md">
# Sitemap (Draft)

## Primary navigation
- Home (/)
- Connect
  - Plan a Visit (/connect/plan-a-visit)
  - Worship With Us (/connect/worship-with-us)
  - About (/connect/about)
  - Events (/connect/events)
  - Team (/connect/team)
  - Contact (/connect/contact)
- Join
  - Membership (/join/membership)
  - Baptism (/join/baptism)
- Ministries
  - Directory (/ministries)
  - Detail pages (/ministries/<slug>)
- Resources
  - Forms (/resources/forms)
  - Prayer (/resources/prayer)
  - Study (/resources/study)
  - Bulletins (/resources/bulletin)
- Serve
  - Volunteer (/serve)
- Media
  - Live (/media/live)
  - Videos (/media/videos)

## Quick actions (header)
- Give (external)
- Request Prayer (external or /resources/prayer)
- Bulletin (/resources/bulletin)
- Forms (/resources/forms)
- Watch Live (/media/live)

## Notes
- Keep labels short and familiar.
- Avoid making visitors guess. Use “Plan a Visit” not “New Here?” if that fits your audience.
</file>

<file path="docs/phase-0/working-agreement.md">
# Working Agreement

## Decision-making
- Project owner: TBD
- Content approver: TBD
- Technical maintainer: TBD

## Change workflow
- Small edits (typos, broken links): maintainer can ship same day.
- Schedule changes: require content approver confirmation.
- New pages/sections: require project owner approval.

## Review cadence
- Weekly 15–30 min check-in during Phase 1.
- Emergency fixes as needed.

## Definition of Ready (for Phase 1 tasks)
A task is ready when:
- goal is clear
- acceptance criteria exist
- content (or placeholder) exists
- owner/approver is known
</file>

<file path="docs/deploy.md">
# Deploy notes

This repo builds with Astro + the Cloudflare Worker adapter, so the site ships as static files plus SSR routes that run inside Cloudflare Pages/Workers. The following steps keep deployments reproducible for preview and production when you need to demo or hand off to someone else.

## Environment variables

- `PUBLIC_SITE_URL` (set in CI + Pages) defines the canonical host for sitemap/robots/meta tags. CI exports it as `http://127.0.0.1:4321` to make `astro` render deterministic assets (robots, sitemap, canonical URLs). The same value should match the Pages preview/production domain so absolute URLs stay consistent.
- Cloudflare secrets (Cloudflare Pages project settings or `wrangler publish`) typically include `CF_ACCOUNT_ID`, `CF_PROJECT_NAME`, and a `CF_API_TOKEN` scoped to publish `pages` & `workers`. Keep them in GitHub secrets or the Pages dashboard and never hardcode them in `web/`.

## Preview workflow

1. From the repo root run `cd web && npm install`.
2. Build and preview with `npm run preview`; Astro uses the Cloudflare adapter and starts a local preview server—any absolute URLs honor `PUBLIC_SITE_URL` if you export it before running the command.
3. For emulator parity you can run `npx wrangler dev --local --ip 127.0.0.1 --port 4321` to exercise the Cloudflare Worker runtime; combine this with `npm run build` so the server uses the exact SSR bundle that Pages would deploy.

## Production deployments

1. Cloudflare Pages automatically picks up `web/` (build command `npm run build`) and uses `wrangler publish` under the hood when you connect the GitHub repo.
2. Ensure the Pages project’s production branch matches `main`/`master` and the `PUBLIC_SITE_URL` secret equals the published domain (e.g., `https://firstspringfieldma.adventistchurch.org`). This keeps canonical tags and sitemap URLs stable.
3. When you push, the existing CI job runs `npm run test:e2e:ci`, `npm run test:links:ci`, and `lhci` assertions before handing the built `web/dist` folder off to Pages.

## Verifying sitemap + robots + canonical output

1. After `npm run build`, inspect `web/dist/sitemap.xml` and `web/dist/robots.txt` to confirm URLs point to `PUBLIC_SITE_URL`.
2. The CI job already sets the same environment variable and runs `npm run build`, meaning the generated files in CI should match the deployed output. Re-run `npm run lighthouse` locally to surface canonical/robots warnings if they regress.
3. Build artifacts (`web/.lighthouseci` and `web/dist`) and the smoke suite ensure canonical links do not regress—check the CI artifacts or rerun `npm run qa` locally when you need to audit metadata behavior before shipping.
</file>

<file path="docs/ui-handoff.md">
# UI Handoff - First Springfield SDA Website

## 1) Design goals
- Calm, readable, welcoming tone with generous breathing room and restrained color.
- Mobile-first layout, fast loads, minimal JS (Astro SSR + partial hydration only where necessary).
- Accessible interactions: clear focus-visible rings, 44px+ tap targets, text that reads well across screen sizes.

## 2) Breakpoints (responsive rules)
Source of truth: `web/src/styles/global.css`.
- Base: mobile-first stack — `.stack`, hero, cards, and nav all stack vertically using tokens so there is no media query assumption.
- `@media (max-width: 860px)`: hides desktop `nav`/`cta` stacks, surfaces the mobile `details.menu`, and tightens `.main` padding to `var(--space-6)` while keeping all sections legible.
- `@media (max-width: 520px)` and `(max-width: 420px)`: collapse footer columns into single-column flow and hide the menu label to preserve tap area while keeping the icon visible.

## 3) Spacing scale (tokens)
Source of truth: `web/src/styles/tokens.css`.

| Token | Intended use | Examples |
|------|--------------|----------|
| `--space-1` | micro gaps or icon/text separation | `header .brand` gap, `.footer-contact` stack spacing |
| `--space-2` | petite padding between inline elements | button gutters, card subtitle margin, `.col-body` link spacing |
| `--space-3` | standard rhythm between sections | `.stack` spacing, hero actions gap, mobile nav spacing |
| `--space-4` | generous separation / nested stacks | hero-inner gap, `.hero` vs hero background, `grid` gap |
| `--space-6` | card padding or section padding inside containers | `.card` padding, `.inner` padding top/bottom, footer body padding |
| `--space-8` | container padding and major vertical gaps | `.main` padding, `Header` inner padding, `.stack--loose` |
| `--space-12` | extra-wide sections if/when needed | large hero spacing or future horizontal rules |

Implementation notes:
- Import tokens once (`@import "./tokens.css"`) and reference via `var(--space-*)` to keep vertical rhythm consistent.
- Use `.stack`, `.grid`, and `.cluster` utility classes from `global.css` so spacing scales with the same token set rather than hard-coded px values.

## 4) Typography scale (global rules)
Source of truth: `web/src/styles/global.css`.
- Base `body` font size is `var(--font-size-1)` (1rem) with a 1.6 line-height.
- Headings rely on `clamp()` for responsiveness:
  - `h1`: clamp(2.2rem, 1.6rem + 2.4vw, 3.2rem) for hero-level impact.
  - `h2`: clamp(1.6rem, 1.2rem + 1.6vw, 2.4rem) for section headers.
  - `h3`: clamp(1.25rem, 1.05rem + 1vw, 1.7rem) for subsections.
- Paragraphs and lists are capped at 70ch to hit the 60–80ch readability target.
- Hero component overrides `h1` (`clamp(2.4rem ... 3.5rem)`) and adds a `muted` subtitle with its own clamp.

## 5) Color + elevation
Source of truth: `web/src/styles/tokens.css`.
- Surfaces: `--color-bg`, `--color-surface`, `--color-surface-2`, and `--color-surface-muted` keep backgrounds and cards light.
- Text: `--color-text`, `--color-text-muted`, `--color-primary`, `--color-primary-hover`, and `--color-focus` drive links, CTAs, and focus outlines.
- Borders use `--color-border` / `--color-border-strong` with consistent `--radius-*` rounding (cards, buttons, menu, footer).
- Elevation: `--shadow-1` for cards, `--shadow-2` for hover states (cards, menu panel), no complex layering keeps performance predictable.

## 6) Components catalog (what exists + how to use)
### Button
File: `web/src/components/ui/Button.astro`
- Variants: `primary` (solid key actions), `secondary` (light background, dark border), `ghost` (transparent, outlines), plus implicit text/inline usage through `ButtonLink`.
- Sizes: `sm`, `md`, `lg` adjust font-size (vars `--font-size-0..2`) and padding (`--space-2..6`).
- States:
  - `hover`: darkens (`--color-primary-hover`) or swaps to gray hover fills.
  - `focus-visible`: global `outline: 3px solid var(--color-focus)` via `global.css` keeps keyboard nav visible.
  - `disabled`: not styled explicitly, so rely on native browser styling; add `disabled` prop before applying `Button` for future needs.
- Uses `var(--space-2)` for gaps and ensures `min-height: var(--target-min)` for 44px tap targets.

### Card
File: `web/src/components/ui/Card.astro`
- Reused for service cards, announcements, and hero wrapper (`<section class="hero card">`).
- Provides `card`/`card--link` classes defined globally (background, border, radius, shadows) and tailored title/description text.
- Outline: `card__title` uses `--font-size-2`, `card__desc` uses `muted` color, and CTAs reuse `.link` styling for hover/focus.

### Hero
File: `web/src/components/ui/Hero.astro`
- Wraps title/subtitle + CTA buttons in `.hero.card` to reuse card surface rules.
- `hero__inner` grid uses `--space-4`; `hero__title` and `hero__subtitle` each define their own `clamp()` scalings.
- CTA stack uses `--space-3` so buttons align vertically on mobile yet stay horizontal when space is available.

### Header / Nav
File: `web/src/components/global/Header.astro`
- Brand link + nav items are laid out in a 3-column grid inside `.inner` with container padding/token values.
- Desktop nav vs mobile menu (`details.menu` + `.menu__panel`), including quick actions derived from `site.quickActions`.
- Nav links highlight active route (`aria-current`) and use `var(--space-2)` gaps, so `--space-3` spacing between the nav cluster and CTA group.
- Mobile menu uses `var(--shadow-2)` and `--radius-3` to match overall surface language; event listener closes menu when selecting a link.

### Footer
File: `web/src/components/global/Footer.astro`
- Two-part layout: info column + nav grid, all inside `.inner` with `var(--space-6)` padding.
- Uses `.links` helper and `var(--space-2)` gap to keep links stacked, and `@media (max-width: 520px)` collapses columns to full width.
- Includes dynamic sections (primary/exploratory nav, quick actions, service times) sourced from `site.nav`, `site.quickActions`, and `site.schedule`.

## 7) Accessibility checklist (project expectations)
- Keyboard navigation: global `a:focus-visible`, `button:focus-visible`, and `summary:focus-visible` outlines defined in `global.css` for consistent focus states.
- Skip link (`.skip-link`) is available globally and reveals itself on focus so screen-reader/keyboard users can jump straight to `.main`.
- Tap targets: `--target-min` enforces 44px+ heights for buttons, nav pills, menu links.
- Semantic text: `heading` scalings, `muted` helpers, and list height constraints keep readability high, and `Hero` CTA order remains logical.
- Images (e.g., `Hero` and CTA icons) should always include `alt` text from the content source; decorative elements rely on empty `alt`.

## 8) “Design-to-code” notes
- Tokens live in `web/src/styles/tokens.css` and are the single source for spacing, color, radius, and typography values.
- Components (`Button`, `Card`, `Hero`, `Header`, `Footer`) rely on tokens instead of raw px to preserve rhythm as screen widths change.
- Responsive rules mirror tokens: `.stack`, `.grid`, `.container`, and media queries share numeric values from the tokens file for predictable scaling.
- Animations/transitions are minimal (`120–160ms ease`) and tied to hover/focus states in `global.css`; keep new interactions aligned with that timing.

## 9) Screenshots & callouts
- ![Home hero callout](assets/home-hero.png) Spacing uses `--space-3` between stacked sections, matching the `.stack` gap in `global.css`.
- ![Plan a Visit callout](assets/plan-visit.png) Typography: `h2` uses `clamp()` to scale with viewport width (`global.css`).
- ![Footer callout](assets/footer.png) Footer spacing leans on `--space-4`/`--space-6` to keep columns breathing and align with the header container.

## 10) Decision log
- Why Astro: content-first rendering with partial hydration keeps the site fast and lets us pull in Markdown/data without heavy bundling.
- Why tokens: centralized spacing/color/typescale means any new component can reuse variables instead of uncoordinated values.
- Why smoke tests: quick, cross-engine smoke tests give confidence that renders stay consistent without slowing down the full CI pipeline.
</file>

<file path="docs/ui-reliability.md">
# UI reliability notes

This page explains the known UI failure modes we monitor so we can triage common issues, keep the experience responsive, and communicate how the build/release pipeline proves behavior before every deploy.

## Failure: YouTube embed blocked / slow network

- **User impact:** The sermon/media player takes center stage on the media page, so a blocked iframe can freeze loading above-the-fold content and make the hero section feel inert.
- **How the UI behaves:** The media section renders a retry-friendly CTA (watch live / try again) and drops the iframe in favor of a descriptive fallback tile with the video title and transcript preview so the rest of the page remains interactive.
- **How we test it:** The Playwright smoke suite includes `/media` coverage (see `web/tests/e2e/smoke.spec.ts`) and the a11y sweep catches residual UI shifts; we manually simulate iframe route abortion when diagnosing regressions, and `npx playwright test --project=chromium --grep media` lets us run a blocked request locally. Lighthouse CI budgets highlight any layout shift that might come from repeated iframe retries.

## Failure: Missing content collection item

- **User impact:** The equal-width grids (cards, ministries, events) depend on CMS content collections; a missing item leaves a hole that feels like a broken card or outdated listing.
- **How the UI behaves:** We render placeholder cards with the `Card` component plus muted copy, and the grid gracefully collapses while `Linkinator`/Playwright watchers flag the missing link. Content editors get a descriptive notification in the admin so they can republish.
- **How we test it:** `astro check` validates generated types inside `web/src/content`, Playwright smoke checks the `CardGrid` (`/` page) for fallout, and `linkinator.config.json` ensures published links exist. During local debugging we stub the collection (commented fixture) so we can observe the placeholder state while keeping CI green.

## Failure: Search index not ready

- **User impact:** The Pagefind-powered search overlay is often the first thing visitors touch when they land on a new topic; if the index build is in progress the search input returns no results and may mislead the user.
- **How the UI behaves:** We render a skeleton input and button with “Retry search” copy, show inline microcopy explaining the cold start, and keep the search modal open so the user can retry without navigating away.
- **How we test it:** The `phase-7-a11y` Axe test (`web/tests/e2e/phase-7-a11y.spec.ts`) already spins up the search modal and verifies accessible labels; we extend that harness with the “Search index not ready” copy while manually blocking the `/pagefind-ui` endpoint during regression runs. Lighthouse budgets guard for the skeleton’s CLS/pause, and Playwright smoke tests executed during CI ensure the UI still renders with mock search results even when the service is offline.

## Reliability signals

- Automated tooling (Playwright smoke + axe, Linkinator, Lighthouse CI) runs on every push—see `web/test-results` and `web/playwright.config.ts` for CI entry points.
- For quick triage, rerun `npm run qa` inside `web/` to reproduce a failure locally while hitting the same test matrix we rely on in CI.
</file>

<file path="web/.vscode/extensions.json">
{
  "recommendations": ["astro-build.astro-vscode"],
  "unwantedRecommendations": []
}
</file>

<file path="web/.vscode/launch.json">
{
  "version": "0.2.0",
  "configurations": [
    {
      "command": "./node_modules/.bin/astro dev",
      "name": "Development server",
      "request": "launch",
      "type": "node-terminal"
    }
  ]
}
</file>

<file path="web/public/_headers">
/*
  X-Content-Type-Options: nosniff
  Referrer-Policy: strict-origin-when-cross-origin
  X-Frame-Options: DENY
  Permissions-Policy: geolocation=(), microphone=(), camera=()
</file>

<file path="web/public/.assetsignore">
_worker.js
_routes.json
</file>

<file path="web/src/components/sections/Hero.astro">
---
import HeroUI from "../ui/Hero.astro";

export type Props = {
  title: string;
  subtitle?: string;
  primaryCtaLabel?: string;
  primaryCtaHref?: string;
  secondaryCtaLabel?: string;
  secondaryCtaHref?: string;
};

const props = Astro.props as Props;
---

<HeroUI {...props} />
</file>

<file path="web/src/components/sections/RecurringActivities.astro">
---
import { oneOffEvents, recurringActivities } from "../../data/activities";
import { site } from "../../data/site";

type Props = {
  title?: string;
  subtitle?: string;
  showNotes?: boolean;
};

const { title = "Activities", subtitle, showNotes = true } = Astro.props;

const now = new Date();
const startOfToday = new Date(now.getFullYear(), now.getMonth(), now.getDate());
const fmtDate = new Intl.DateTimeFormat(site.locale, {
  dateStyle: "medium",
  timeZone: site.timeZone
});
const fmtDateTime = new Intl.DateTimeFormat(site.locale, {
  dateStyle: "medium",
  timeStyle: "short",
  timeZone: site.timeZone
});

const isFilled = (value?: string) => Boolean(value && value.trim() && value !== "TBD");
const cleanedRecurring = recurringActivities.filter((activity) => {
  const title = activity.title?.trim();
  if (!title || title.toLowerCase().startsWith("etc")) {
    return false;
  }
  return isFilled(activity.cadence) || isFilled(activity.time);
});

const oneOffUpcoming = oneOffEvents
  .map((event) => {
    const startAt = new Date(event.start);
    return {
      ...event,
      startAt,
      hasTime: event.start.includes("T")
    };
  })
  .filter((event) => {
    if (Number.isNaN(event.startAt.valueOf())) {
      return false;
    }
    return event.hasTime ? event.startAt >= now : event.startAt >= startOfToday;
  })
  .sort((a, b) => a.startAt.valueOf() - b.startAt.valueOf());
---

<section class="stack">
  <header class="stack--tight">
    <h2>{title}</h2>
    {subtitle && <p class="muted">{subtitle}</p>}
  </header>

  {oneOffUpcoming.length > 0 && (
    <div class="stack--tight">
      <h3>One-off events</h3>
      <ul class="recurring-list">
        {oneOffUpcoming.map((event) => (
          <li class="recurring-item">
            <p class="recurring-text">
              {event.link ? <a href={event.link}>{event.title}</a> : <span>{event.title}</span>}
              {` on ${
                event.hasTime ? fmtDateTime.format(event.startAt) : fmtDate.format(event.startAt)
              }`}
            </p>
            {showNotes && event.note && <span class="recurring-note">{event.note}</span>}
          </li>
        ))}
      </ul>
    </div>
  )}

  {oneOffUpcoming.length > 0 && <h3>Recurring activities</h3>}
  <ul class="recurring-list">
    {cleanedRecurring.map((activity) => (
      <li class="recurring-item">
        <p class="recurring-text">
          {activity.link ? (
            <a href={activity.link}>{activity.title}</a>
          ) : (
            <span>{activity.title}</span>
          )}
          {activity.cadence && ` ${activity.cadence}`}
          {activity.time && ` at ${activity.time}`}
          {(activity.cadence || activity.time) && "."}
        </p>
        {showNotes && activity.note && <span class="recurring-note">{activity.note}</span>}
      </li>
    ))}
  </ul>
</section>

<style>
  .recurring-list {
    list-style: none;
    margin: 0;
    padding: 0;
    display: grid;
    gap: var(--space-3);
  }

  .recurring-item {
    display: grid;
    gap: var(--space-1);
  }

  .recurring-text {
    margin: 0;
    font-size: 1rem;
  }

  .recurring-text a {
    font-weight: 600;
    text-decoration: none;
  }

  .recurring-text a:hover {
    text-decoration: underline;
  }

  .recurring-note {
    font-size: 0.85rem;
    color: var(--color-text-muted);
  }
</style>
</file>

<file path="web/src/components/ui/ButtonLink.astro">
---
import Button from "./Button.astro";

type Props = {
  href: string;
  external?: boolean;
  variant?: "primary" | "secondary";
  size?: "sm" | "md" | "lg";
};

const { href, external, variant = "primary", size = "md" } = Astro.props;
---

<Button href={href} external={external} variant={variant} size={size}>
  <slot />
</Button>
</file>

<file path="web/src/components/ui/MapEmbed.astro">
---
export interface Props {
  src: string;
  title?: string;
}
const { src, title = "Map" } = Astro.props;
---

<div class="map-embed">
  <iframe
    src={src}
    title={title}
    loading="lazy"
    referrerpolicy="no-referrer-when-downgrade"
    allowfullscreen
  ></iframe>
</div>

<style>
  .map-embed {
    border: 1px solid var(--color-border);
    border-radius: var(--radius-3);
    overflow: hidden;
    aspect-ratio: 16 / 9;
    background: var(--color-surface);
  }

  .map-embed iframe {
    width: 100%;
    height: 100%;
    border: 0;
    display: block;
  }
</style>
</file>

<file path="web/src/components/ui/YouTubeEmbed.astro">
---
import YouTubeEmbedMedia from "../media/YouTubeEmbed.astro";

export type Props = {
  title: string;
  /** Full YouTube embed URL, e.g. https://www.youtube.com/embed/VIDEO_ID */
  embedUrl: string;
};

const props = Astro.props as Props;
---

<YouTubeEmbedMedia {...props} />
</file>

<file path="web/src/components/Welcome.astro">
---
import astroLogo from '../assets/astro.svg';
import background from '../assets/background.svg';
---

<div id="container">
	<img id="background" src={background.src} alt="" fetchpriority="high" />
	<main>
		<section id="hero">
			<a href="https://astro.build"
				><img src={astroLogo.src} width="115" height="48" alt="Astro Homepage" /></a
			>
			<h1>
				To get started, open the <code><pre>src/pages</pre></code> directory in your project.
			</h1>
			<section id="links">
				<a class="button" href="https://docs.astro.build">Read our docs</a>
				<a href="https://astro.build/chat"
					>Join our Discord <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36"
						><path
							fill="currentColor"
							d="M107.7 8.07A105.15 105.15 0 0 0 81.47 0a72.06 72.06 0 0 0-3.36 6.83 97.68 97.68 0 0 0-29.11 0A72.37 72.37 0 0 0 45.64 0a105.89 105.89 0 0 0-26.25 8.09C2.79 32.65-1.71 56.6.54 80.21a105.73 105.73 0 0 0 32.17 16.15 77.7 77.7 0 0 0 6.89-11.11 68.42 68.42 0 0 1-10.85-5.18c.91-.66 1.8-1.34 2.66-2a75.57 75.57 0 0 0 64.32 0c.87.71 1.76 1.39 2.66 2a68.68 68.68 0 0 1-10.87 5.19 77 77 0 0 0 6.89 11.1 105.25 105.25 0 0 0 32.19-16.14c2.64-27.38-4.51-51.11-18.9-72.15ZM42.45 65.69C36.18 65.69 31 60 31 53s5-12.74 11.43-12.74S54 46 53.89 53s-5.05 12.69-11.44 12.69Zm42.24 0C78.41 65.69 73.25 60 73.25 53s5-12.74 11.44-12.74S96.23 46 96.12 53s-5.04 12.69-11.43 12.69Z"
						></path></svg
					>
				</a>
			</section>
		</section>
	</main>

	<a href="https://astro.build/blog/astro-5/" id="news" class="box">
		<svg width="32" height="32" fill="none" xmlns="http://www.w3.org/2000/svg"
			><path
				d="M24.667 12c1.333 1.414 2 3.192 2 5.334 0 4.62-4.934 5.7-7.334 12C18.444 28.567 18 27.456 18 26c0-4.642 6.667-7.053 6.667-14Zm-5.334-5.333c1.6 1.65 2.4 3.43 2.4 5.333 0 6.602-8.06 7.59-6.4 17.334C13.111 27.787 12 25.564 12 22.666c0-4.434 7.333-8 7.333-16Zm-6-5.333C15.111 3.555 16 5.556 16 7.333c0 8.333-11.333 10.962-5.333 22-3.488-.774-6-4-6-8 0-8.667 8.666-10 8.666-20Z"
				fill="#111827"></path></svg
		>
		<h2>What's New in Astro 5.0?</h2>
		<p>
			From content layers to server islands, click to learn more about the new features and
			improvements in Astro 5.0
		</p>
	</a>
</div>

<style>
	#background {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: -1;
		filter: blur(100px);
	}

	#container {
		font-family: Inter, Roboto, 'Helvetica Neue', 'Arial Nova', 'Nimbus Sans', Arial, sans-serif;
		height: 100%;
	}

	main {
		height: 100%;
		display: flex;
		justify-content: center;
	}

	#hero {
		display: flex;
		align-items: start;
		flex-direction: column;
		justify-content: center;
		padding: 16px;
	}

	h1 {
		font-size: 22px;
		margin-top: 0.25em;
	}

	#links {
		display: flex;
		gap: 16px;
	}

	#links a {
		display: flex;
		align-items: center;
		padding: 10px 12px;
		color: #111827;
		text-decoration: none;
		transition: color 0.2s;
	}

	#links a:hover {
		color: rgb(78, 80, 86);
	}

	#links a svg {
		height: 1em;
		margin-left: 8px;
	}

	#links a.button {
		color: white;
		background: linear-gradient(83.21deg, #3245ff 0%, #bc52ee 100%);
		box-shadow:
			inset 0 0 0 1px rgba(255, 255, 255, 0.12),
			inset 0 -2px 0 rgba(0, 0, 0, 0.24);
		border-radius: 10px;
	}

	#links a.button:hover {
		color: rgb(230, 230, 230);
		box-shadow: none;
	}

	pre {
		font-family:
			ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono',
			monospace;
		font-weight: normal;
		background: linear-gradient(14deg, #d83333 0%, #f041ff 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
		margin: 0;
	}

	h2 {
		margin: 0 0 1em;
		font-weight: normal;
		color: #111827;
		font-size: 20px;
	}

	p {
		color: #4b5563;
		font-size: 16px;
		line-height: 24px;
		letter-spacing: -0.006em;
		margin: 0;
	}

	code {
		display: inline-block;
		background:
			linear-gradient(66.77deg, #f3cddd 0%, #f5cee7 100%) padding-box,
			linear-gradient(155deg, #d83333 0%, #f041ff 18%, #f5cee7 45%) border-box;
		border-radius: 8px;
		border: 1px solid transparent;
		padding: 6px 8px;
	}

	.box {
		padding: 16px;
		background: rgba(255, 255, 255, 1);
		border-radius: 16px;
		border: 1px solid white;
	}

	#news {
		position: absolute;
		bottom: 16px;
		right: 16px;
		max-width: 300px;
		text-decoration: none;
		transition: background 0.2s;
		backdrop-filter: blur(50px);
	}

	#news:hover {
		background: rgba(255, 255, 255, 0.55);
	}

	@media screen and (max-height: 368px) {
		#news {
			display: none;
		}
	}

	@media screen and (max-width: 768px) {
		#container {
			display: flex;
			flex-direction: column;
		}

		#hero {
			display: block;
			padding-top: 10%;
		}

		#links {
			flex-wrap: wrap;
		}

		#links a.button {
			padding: 14px 18px;
		}

		#news {
			right: 16px;
			left: 16px;
			bottom: 2.5rem;
			max-width: 100%;
		}

		h1 {
			line-height: 1.5;
		}
	}
</style>
</file>

<file path="web/src/content/bulletins/2025-12-13.md">
---
title: "Sabbath Bulletin"
date: "2025-12-13"
summary: "Archive sample bulletin."
pdfUrl: "/bulletins/2025-12-13.pdf"
---
</file>

<file path="web/src/content/bulletins/2025-12-20.md">
---
title: "Sabbath Bulletin"
date: "2025-12-20"
summary: "Order of service, announcements, and weekly schedule."
pdfUrl: "/bulletins/2025-12-20.pdf"
---
</file>

<file path="web/src/content/bulletins/2026-01-03.md">
---
title: "Sabbath Bulletin"
date: "2026-01-03"
summary: "Order of service, announcements, and weekly schedule."
pdfUrl: "/bulletins/2026-01-03.pdf"
---
</file>

<file path="web/src/content/ministries/adult-sabbath-school.md">
---
title: "Adult Sabbath School"
summary: "A Christ-centered Sabbath School focused on prayer, member care, service, and Bible study."
leaderName: "Sabbath School Superintendent"
leaderEmail: "firstspringfieldsda@gmail.com"
meetingTime: "Sabbaths at 10:00 AM"
category: "Bible Study"
tags: ["adult", "sabbath school", "bible study", "prayer", "service"]
---

## Mission Statement

The Mission of the Adult Sabbath School Department of the First Springfield Seventh-day Adventist Church is to provide structured opportunities for its members and visitors to experience a living relationship with Jesus Christ through an emphasis on prayer, member care, service, and Bible study.

## Goals and Objectives

<div class="grid--cards">
  <div class="card stack--tight">
    <h3>Prayer</h3>
    <p>
      We recognize that prayer is a primary foundation of Spiritual life. Therefore, each class will
      spend time in group prayer. Ample opportunity will be made to receive prayer requests, and prayer
      will be made not only by class leaders, but individual members will pray for class needs, church
      needs, and the overall importance of each person being filled with the Holy Spirit.
    </p>
  </div>
  <div class="card stack--tight">
    <h3>Member Care</h3>
    <p>
      We recognize that each individual is a part of the larger body, and that Scripture calls us to
      care for one another. Therefore, each class will spend time in discerning the needs of its
      members, and planning ways to reach out and meet those needs. Obeying the Scriptural injunction
      to "Bear one another's burdens," we will seek to lift the spiritual, social, emotional, and
      financial needs of our brothers and sisters within the family of God as we have opportunity.
      Each class will seek to reach out to its inactive or missing members in a regular and consistent
      manner.
    </p>
  </div>
  <div class="card stack--tight">
    <h3>Service</h3>
    <p>
      We recognize that God has directed that service be the criteria by which greatness is measured.
      Following our Lord's example, each class will plan and execute a service program in some area of
      need. Such programs will range from practical help given to needy persons to evangelistic or
      missionary work in the Pioneer Valley area, or even in the larger world field as God leads.
      Opportunities will be provided to receive training that will facilitate the outreach of the
      Sabbath School program.
    </p>
  </div>
  <div class="card stack--tight">
    <h3>Bible Study</h3>
    <p>
      We recognize that the study of Scripture is the primary way that we may come to know our Lord
      Jesus Christ and the power of His gospel. Seeking to increase our understanding of Scripture,
      each class will spend time in appropriate and relevant Bible study, using either the Adult
      Sabbath School Quarterly, or other materials approved by the Sabbath School Council. New classes
      will be encouraged to form that center around shared interests and needs as it pertains to
      applying Scripture to all aspects of our lives.
    </p>
  </div>
</div>
</file>

<file path="web/src/content/ministries/adventurers.md">
---
title: "Adventurers"
summary: "A fun, faith-based club for children and their families."
leaderName: "Adventurers Leaders"
leaderEmail: "firstspringfieldsda@gmail.com"
meetingTime: "1st and 3rd Sabbath"
category: "Children & Youth"
tags: ["kids", "families", "faith"]
---

## Overview

Adventurers helps kids grow in faith, friendships, and family involvement.

## How to get involved

Come to a meeting or contact the leaders to learn more.
</file>

<file path="web/src/content/ministries/bible-study.md">
---
title: "Bible Study"
summary: "Interactive study and discussion of Scripture."
leaderName: "Bible Study Facilitator"
leaderEmail: "firstspringfieldsda@gmail.com"
meetingTime: "4th Sabbath"
category: "Bible Study"
tags: ["bible", "study", "growth"]
---

## Overview

We read the Bible together and talk about how to live it out.

## How to get involved

Bring your Bible and join the discussion.
</file>

<file path="web/src/content/ministries/board-meeting.md">
---
title: "Board Meeting"
summary: "Monthly planning and oversight for church leadership."
leaderName: "Church Board"
leaderEmail: "firstspringfieldsda@gmail.com"
meetingTime: "2nd Tuesday"
category: "Leadership"
draft: true
tags: ["leadership", "members"]
---

## Overview

Board meetings are for members and invited guests to plan and shepherd church life.

## How to get involved

If you are a board member, watch for the monthly agenda and meeting link.
</file>

<file path="web/src/content/ministries/community-meal-spaghetti.md">
---
title: "Community Meal - Spaghetti"
summary: "A free community meal to share food, fellowship, and care."
leaderName: "Community Meal Team"
leaderEmail: "firstspringfieldsda@gmail.com"
meetingTime: "4th Wednesday"
category: "Outreach"
tags: ["outreach", "community", "hospitality"]
---

## Overview

Neighbors are welcome to a warm meal and friendly conversation.

## How to get involved

Volunteer or invite a friend to join us.
</file>

<file path="web/src/content/ministries/mens-ministry.md">
---
title: "Men's Ministry"
summary: "Brotherhood, prayer, and service to strengthen men of faith."
leaderName: "Men's Ministry Team"
leaderEmail: "firstspringfieldsda@gmail.com"
meetingTime: "Fridays at 7:00 PM"
category: "Men"
tags: ["men", "fellowship", "service"]
---

## Overview

We gather for encouragement, prayer, and practical ways to serve families and the church.

## How to get involved

Reach out to the leader or show up on a Friday night.
</file>

<file path="web/src/content/ministries/pathfinders.md">
---
title: "Pathfinders"
summary: "A Christ-centered club for teens focused on leadership, service, and adventure."
leaderName: "Pathfinders Leadership"
leaderEmail: "firstspringfieldsda@gmail.com"
meetingTime: "1st and 3rd Sabbath"
category: "Children & Youth"
tags: ["youth", "teens", "discipleship"]
---

## Overview

We help teens build friendships, skills, and a deeper walk with Jesus.

## How to get involved

Join a meeting or contact the leaders for details.
</file>

<file path="web/src/content/ministries/womens-ministry.md">
---
title: "Women's Ministry"
summary: "Connection, encouragement, and discipleship for women of all ages."
leaderName: "Women's Ministry Team"
leaderEmail: "firstspringfieldsda@gmail.com"
meetingTime: "1st Tuesday of each month"
category: "Women"
tags: ["women", "discipleship", "community"]
---

## Overview

We meet to grow in faith, share life, and support one another.

## How to get involved

Contact the ministry team to get the latest details.
</file>

<file path="web/src/data/activities.ts">
export type RecurringActivity = {
  title: string;
  cadence: string;
  time: string;
  link: string;
  note: string;
};

export type OneOffEvent = {
  title: string;
  start: string;
  link?: string;
  note?: string;
};

export const recurringActivities: RecurringActivity[] = [
  {
    title: "Pathfinders and Adventurers",
    cadence: "meet on the first and third Sabbath",
    time: "",
    link: "/ministries/pathfinders",
    note: "Public"
  },
  {
    title: "Board meeting",
    cadence: "is on the second Tuesday of every month",
    time: "",
    link: "/ministries/board-meeting",
    note: "Members only"
  },
  {
    title: "Men's ministry",
    cadence: "is every Friday",
    time: "7:00 PM",
    link: "/ministries/mens-ministry",
    note: "Public"
  },
  {
    title: "Women's ministry",
    cadence: "is on the first Tuesday of every month",
    time: "",
    link: "/ministries/womens-ministry",
    note: "Public"
  },
  {
    title: "Free spaghetti dinner",
    cadence: "the 4th Wednesday of every month",
    time: "",
    link: "/ministries/community-meal-spaghetti",
    note: "Public"
  },
  {
    title: "Bible study",
    cadence: "the 4th Sabbath",
    time: "",
    link: "/ministries/bible-study",
    note: "Public"
  }
];

export const oneOffEvents: OneOffEvent[] = [];
</file>

<file path="web/src/data/videos.json">
[
  {
    "title": "Sabbath Worship Service",
    "date": "2025-12-13",
    "youtubeId": "TBD",
    "summary": "Weekly worship service."
  },
  {
    "title": "Bible Study / Message",
    "date": "2025-12-06",
    "youtubeId": "TBD",
    "summary": "Sermon and reflection."
  },
  {
    "title": "Special Program",
    "date": "2025-11-29",
    "youtubeId": "TBD",
    "summary": "Guest speaker or special event."
  }
]
</file>

<file path="web/src/layouts/Layout.astro">
<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>Astro Basics</title>
	</head>
	<body>
		<slot />
	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}
</style>
</file>

<file path="web/src/pages/404.astro">
---
import BaseLayout from "../layouts/BaseLayout.astro";
---

<BaseLayout title="Page not found">
  <h1>Page not found</h1>
  <p class="muted">We couldn’t find that page. Try one of these options:</p>

  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/media">Media</a></li>
    <li><a href="/give">Give</a></li>
    <li><a href="/connect">Connect</a></li>
  </ul>
</BaseLayout>
</file>

<file path="web/src/pages/components.astro">
---
import BaseLayout from "../layouts/BaseLayout.astro";
import Button from "../components/ui/Button.astro";
import Banner from "../components/ui/Banner.astro";
import Card from "../components/ui/Card.astro";

const buttonVariants = [
  { label: "Primary", variant: "primary" },
  { label: "Secondary", variant: "secondary" },
  { label: "Ghost", variant: "ghost" },
];

const buttonSizes = [
  { label: "Small", size: "sm" },
  { label: "Medium (default)", size: "md" },
  { label: "Large", size: "lg" },
];

const linkSamples = [
  { label: "Plan a visit", href: "/connect/plan-a-visit", helper: "Internal CTA", external: false },
  {
    label: "Design handoff notes",
    href: "/docs/ui-handoff.md",
    helper: "Documents align with design tokens",
    external: false,
  },
  {
    label: "Cross-device guide",
    href: "https://playwright.dev/docs/test-configuration",
    helper: "External resource (opens new tab)",
    external: true,
  },
];

const cards = [
  {
    title: "Service snapshot",
    description: "Button-driven CTAs magnify the worship preview and giving link.",
    href: "/connect/worship-with-us",
  },
  {
    title: "Ministry stories",
    description: "Cards frame the latest community updates without extra markup.",
  },
];

const badges = [
  { label: "New", className: "badge badge--primary" },
  { label: "Draft", className: "badge badge--muted" },
  { label: "Alert", className: "badge badge--warn" },
];

const tableRows = [
  { component: "Button", usage: "Primary, secondary, ghost shapes", pattern: "Hero/CTA pattern" },
  { component: "Banner", usage: "Info + warning alerts", pattern: "Announcements + policy changes" },
  { component: "Card", usage: "Service/ministry highlights", pattern: "Grid + stack layouts" },
];

const listItems = [
  "Spacing relies on `var(--space-*)` tokens that keep grids and stacks aligned.",
  "Color, border, and focus tokens (*primary, border, focus*) stay consistent site wide.",
  "Animations respect `stack` and `cluster` helpers so cards stay responsive.",
];
---

<BaseLayout title="Components" description="Living component library for First Springfield’s web toolkit.">
  <section class="component-hero">
    <p class="eyebrow">Component library</p>
    <h1>Components</h1>
    <p>
      A compact guide to the shared UI surface, so designers and engineers can see the token-powered elements
      that ship across First Springfield’s site.
    </p>
  </section>

  <section class="component-section">
    <header>
      <h2>Buttons</h2>
      <p>Variants + sizes use the shared tokens so CTAs feel consistent anywhere they appear.</p>
    </header>

    <div class="component-grid component-grid--variants">
      {buttonVariants.map(({ label, variant }) => (
        <article>
          <p class="component-label">{label}</p>
          <Button variant={variant} size="md">{label}</Button>
        </article>
      ))}
    </div>

    <div class="component-grid component-grid--sizes">
      {buttonSizes.map(({ label, size }) => (
        <article>
          <p class="component-label">{label}</p>
          <Button variant="primary" size={size}>{label}</Button>
        </article>
      ))}
    </div>

    <div class="component-grid component-grid--states">
      <article>
        <p class="component-label">Disabled</p>
        <Button variant="primary" size="md" disabled>Disabled</Button>
      </article>
      <article>
        <p class="component-label">Focus-visible</p>
        <Button variant="primary" size="md" autoFocus>Focus state</Button>
      </article>
    </div>
    <p class="component-hint">Use Tab (or the demo focus button) to see the outline from the site-wide focus token.</p>
  </section>

  <section class="component-section">
    <header>
      <h2>Links + external icon behavior</h2>
      <p>Shared link styles highlight internal links and signal external destinations.</p>
    </header>
    <div class="component-grid component-grid--links">
      {linkSamples.map(({ label, href, helper, external }) => (
        <a
          class="component-link"
          href={href}
          target={external ? "_blank" : undefined}
          rel={external ? "noreferrer noopener" : undefined}
        >
          <span>{label}</span>
          <span class="component-link__hint">{helper}</span>
          {external ? <span aria-hidden="true" class="component-link__icon">↗</span> : null}
        </a>
      ))}
    </div>
  </section>

  <section class="component-section">
    <header>
      <h2>Banner states</h2>
      <p>Alert banners sport info or warn tones to stay calm yet clear.</p>
    </header>
    <div class="component-grid component-grid--banners">
      <Banner message="Service updates land here before they reach the hero." tone="info" ctaLabel="Learn more" ctaHref="/connect/about" />
      <Banner message="Safety and campus policies use the warning tone." tone="warn" ctaLabel="Welcoming summary" ctaHref="/connect/worship-with-us" />
    </div>
  </section>

  <section class="component-section">
    <header>
      <h2>Cards & badges</h2>
      <p>Cards stretch into grids; badges keep metadata compact.</p>
    </header>
    <div class="component-grid component-grid--cards">
      {cards.map((card) => (
        <Card title={card.title} description={card.description} href={card.href} />
      ))}
    </div>
    <div class="badge-row">
      {badges.map((badge) => (
        <span class={badge.className}>{badge.label}</span>
      ))}
    </div>
  </section>

  <section class="component-section">
    <header>
      <h2>Table & list styles</h2>
      <p>Responsive tables and stacks keep content legible on every viewport.</p>
    </header>
    <div class="component-table-wrapper">
      <table class="component-table">
        <thead>
          <tr>
            <th scope="col">Component</th>
            <th scope="col">Usage</th>
            <th scope="col">Pattern</th>
          </tr>
        </thead>
        <tbody>
          {tableRows.map((row) => (
            <tr>
              <td>{row.component}</td>
              <td>{row.usage}</td>
              <td>{row.pattern}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
    <ul class="component-list">
      {listItems.map((item) => (
        <li>{item}</li>
      ))}
    </ul>
  </section>
</BaseLayout>

<style>
  .eyebrow {
    text-transform: uppercase;
    letter-spacing: 0.2em;
    font-size: var(--font-size-0);
    margin-bottom: var(--space-2);
    color: var(--color-text-muted);
  }

  .component-hero {
    margin-bottom: var(--space-8);
  }

  .component-section {
    margin-bottom: var(--space-10);
  }

  .component-section header h2 {
    margin: 0 0 var(--space-2);
  }

  .component-section header p {
    margin: 0;
    color: var(--color-text-muted);
  }

  .component-grid {
    display: grid;
    gap: var(--space-4);
    margin-top: var(--space-4);
  }

  .component-grid--variants,
  .component-grid--sizes,
  .component-grid--states {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  }

  .component-grid--links {
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  }

  .component-grid--cards {
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  }

  .component-grid--banners {
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  }

  .component-label {
    margin: 0;
    font-size: var(--font-size-0);
    color: var(--color-text-muted);
  }

  .component-hint {
    margin-top: var(--space-3);
    font-size: var(--font-size-0);
    color: var(--color-text-muted);
  }

  .component-link {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-3);
    padding: var(--space-3);
    text-decoration: none;
    color: inherit;
    background: var(--color-surface);
  }

  .component-link:hover,
  .component-link:focus-visible {
    border-color: var(--color-border-strong);
    box-shadow: var(--shadow-1);
  }

  .component-link__hint {
    font-size: var(--font-size-0);
    color: var(--color-text-muted);
  }

  .component-link__icon {
    font-size: 0.9rem;
    color: var(--color-primary);
  }

  .badge-row {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
    margin-top: var(--space-4);
  }

  .badge {
    display: inline-flex;
    align-items: center;
    padding: var(--space-1) var(--space-3);
    border-radius: var(--radius-2);
    font-weight: 600;
    font-size: var(--font-size-0);
  }

  .badge--primary {
    background: #fdecea;
    color: #991b1b;
  }

  .badge--muted {
    background: var(--color-gray-50);
    color: var(--color-gray-600);
  }

  .badge--warn {
    background: #fff4e5;
    color: #b45309;
  }

  .component-table-wrapper {
    overflow-x: auto;
    margin-top: var(--space-4);
  }

  .component-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--color-border);
  }

  .component-table th,
  .component-table td {
    padding: var(--space-3);
    text-align: left;
    border-bottom: 1px solid var(--color-border);
  }

  .component-table th {
    font-size: var(--font-size-0);
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: var(--color-text-muted);
  }

  .component-list {
    margin-top: var(--space-4);
    padding-left: 1.2rem;
    color: var(--color-text);
  }

  .component-list li + li {
    margin-top: var(--space-2);
  }

  @media (max-width: 640px) {
    .component-grid--variants,
    .component-grid--sizes,
    .component-grid--states {
      grid-template-columns: 1fr;
    }
  }
</style>
</file>

<file path="web/src/pages/robots.txt.ts">
import type { APIRoute } from "astro";

// Force this endpoint to be emitted as a static file in dist/robots.txt
export const prerender = true;

export const GET: APIRoute = ({ site: astroSite, url }) => {
  // Prefer Astro config `site` when present, otherwise use the request origin
  // (important for local LHCI ports like http://localhost:51310)
  const origin = (astroSite?.toString() ?? url.origin).replace(/\/$/, "");

  const sitemapUrl = new URL("/sitemap-index.xml", origin).toString();

  const body = [
    "User-agent: *",
    "Allow: /",
    "",
    `Sitemap: ${sitemapUrl}`,
    "",
  ].join("\n");

  return new Response(body, {
    headers: {
      "Content-Type": "text/plain; charset=utf-8",
      "Cache-Control": "public, max-age=3600",
    },
  });
};
</file>

<file path="web/test-results/.last-run 2.json">
{
  "status": "passed",
  "failedTests": []
}
</file>

<file path="web/test-results/.last-run.json">
{
  "status": "passed",
  "failedTests": []
}
</file>

<file path="web/tests/e2e/mobile.smoke.spec.ts">
import { test, expect } from '@playwright/test';

test.describe('Smoke - mobile device', () => {
  test('mobile header nav and primary CTA stay accessible on home', async ({ page }) => {
    await page.goto('/');
    await expect(page.locator('header nav')).toBeVisible();
    await expect(page.getByRole('link', { name: /give/i })).toBeVisible();
    await expect(page.getByRole('link', { name: /watch live/i })).toBeVisible();
  });

  test('visit page loads key content and CTA', async ({ page }) => {
    await page.goto('/visit');
    await expect(page.getByRole('heading', { level: 1 })).toBeVisible();
    await expect(page.locator('main')).toContainText(/parking|directions|address/i);
    await expect(page.getByRole('link', { name: /give/i })).toBeVisible();
  });
});
</file>

<file path="web/tests/e2e/phase-7-sitefiles.spec.ts">
import { expect, test } from "@playwright/test";

test("robots.txt exists and references sitemap", async ({ page }) => {
  await page.goto("/robots.txt");
  const body = await page.textContent("body");
  expect(body).toContain("User-agent:");
  expect(body).toContain("Sitemap:");
});

test("sitemap index exists", async ({ page }) => {
  await page.goto("/sitemap-index.xml");
  const body = await page.textContent("body");
  expect(body).toContain("<sitemapindex");
});
</file>

<file path="web/tests/e2e/smoke.spec.ts">
import { test, expect } from '@playwright/test';

test.describe('Smoke - cross browser', () => {
  test('home renders primary navigation and CTA', async ({ page }) => {
    await page.goto('/');
    await expect(page.locator('header')).toBeVisible();
    await expect(page.getByRole('link', { name: /watch live/i })).toBeVisible();
    await expect(page.getByRole('link', { name: /give/i })).toBeVisible();
  });

  test('plan a visit page loads key content', async ({ page }) => {
    await page.goto('/visit');
    await expect(page.getByRole('heading', { level: 1 })).toBeVisible();
    await expect(page.locator('main')).toContainText(/parking|directions|address/i);
  });
});
</file>

<file path="web/.gitignore">
# build output
dist/

# generated types
.astro/

# dependencies
node_modules/

# logs
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*

# environment variables
.env
.env.production

# macOS-specific files
.DS_Store

# jetbrains setting folder
.idea/
</file>

<file path="web/lighthouserc.cjs">
module.exports = {
  ci: {
    collect: {
      staticDistDir: "./dist",
      numberOfRuns: 3
    },
    assert: {
      assertions: {
        "categories:performance": ["error", { "minScore": 0.9 }],
        "categories:accessibility": ["error", { "minScore": 0.95 }],
        "categories:seo": ["error", { "minScore": 0.95 }],
        "categories:best-practices": ["error", { "minScore": 0.95 }]
      }
    },
    upload: {
      target: "filesystem",
      outputDir: "./.lighthouseci"
    }
  }
};
</file>

<file path="web/linkinator.config.json">
{
  "recurse": true,
  "cleanUrls": true,
  "checkFragments": true,
  "timeout": 30000,
  "concurrency": 50,
  "skip": [
    "^mailto:",
    "^tel:",
    "^https?://"
  ]
}
</file>

<file path="web/README.md">
# Astro Starter Kit: Basics

```sh
npm create astro@latest -- --template basics
```

> 🧑‍🚀 **Seasoned astronaut?** Delete this file. Have fun!

## 🚀 Project Structure

Inside of your Astro project, you'll see the following folders and files:

```text
/
├── public/
│   └── favicon.svg
├── src
│   ├── assets
│   │   └── astro.svg
│   ├── components
│   │   └── Welcome.astro
│   ├── layouts
│   │   └── Layout.astro
│   └── pages
│       └── index.astro
└── package.json
```

To learn more about the folder structure of an Astro project, refer to [our guide on project structure](https://docs.astro.build/en/basics/project-structure/).

## 🧞 Commands

All commands are run from the root of the project, from a terminal:

| Command                   | Action                                           |
| :------------------------ | :----------------------------------------------- |
| `npm install`             | Installs dependencies                            |
| `npm run dev`             | Starts local dev server at `localhost:4321`      |
| `npm run build`           | Build your production site to `./dist/`          |
| `npm run preview`         | Preview your build locally, before deploying     |
| `npm run astro ...`       | Run CLI commands like `astro add`, `astro check` |
| `npm run astro -- --help` | Get help using the Astro CLI                     |

## 👀 Want to learn more?

Feel free to check [our documentation](https://docs.astro.build) or jump into our [Discord server](https://astro.build/chat).
</file>

<file path="web/wrangler.jsonc">
{
	"main": "dist/_worker.js/index.js",
	"name": "web",
  "compatibility_date": "2025-12-19",
  "compatibility_flags": [
    "nodejs_compat",
    "global_fetch_strictly_public"
  ],
	"assets": {
		"binding": "ASSETS",
		"directory": "./dist"
	},
	"observability": {
    "enabled": true
  }
}
</file>

<file path=".editorconfig">
root = true

[*]
charset = utf-8
end_of_line = lf
insert_final_newline = true
trim_trailing_whitespace = true

[*.md]
trim_trailing_whitespace = false
</file>

<file path=".gitignore">
# Node
node_modules/

# Astro
web/dist/
web/.astro/

# OS
.DS_Store
</file>

<file path=".nvmrc">
20
</file>

<file path="CODE_OF_CONDUCT.md">
# Contributor Covenant Code of Conduct

## Our Pledge

We as members, contributors, and leaders pledge to make participation in this project and our community a harassment-free experience for everyone.

## Our Standards

Examples of behavior that contributes to a positive environment include:
- Using welcoming and inclusive language.
- Being respectful of differing viewpoints and experiences.
- Gracefully accepting constructive criticism.
- Focusing on what is best for the community.
- Showing empathy toward other community members.

Examples of unacceptable behavior include harassment, trolling, insulting/derogatory comments, or other conduct which might reasonably be considered inappropriate.

## Enforcement

Instances of abusive, harassing, or otherwise unacceptable behavior may be reported by contacting conduct@firstspringfieldma.adventistchurch.org. All complaints will be reviewed and investigated promptly and fairly.

## Attribution

This Code of Conduct is adapted from the [Contributor Covenant](https://www.contributor-covenant.org/), version 2.1, available at https://www.contributor-covenant.org/version/2/1/code_of_conduct/.
</file>

<file path="CONTRIBUTING.md">
# Contributing

Thanks for improving First Springfield Church Website! Follow the guidelines below so changes stay reliable and reviewers can move quickly.

## Getting started

1. `git checkout -b feature/description` (use prefixes like `feature/`, `fix/`, `docs/`, `chore/`, etc.).
2. Always run the QA suite before opening a PR so CI has the same baseline:
   ```sh
   cd web
   npm install
   npm run qa
   ```
3. Keep commits focused and descriptive; squash/fixup as needed before merging.

## Branch naming & PR expectations

- Prefer active names like `feature/service-livestream` or `fix/banner-spacing`.
- Title PRs with the change (e.g., “Improve Banner focus states”) and cite the main README section or issue if one exists.
- Describe what was done, list any manual verifications (Lighthouse, Playwright, Linkinator), and attach screenshots when the UI changes.
- Mention any missing coverage or follow-up work in the PR description so reviewers know what to expect.
- Link to `CONTRIBUTING.md`, `SECURITY.md`, or `docs/ui-reliability.md` when relevant.

## Tests & formatting

- `npm run format` touches Astro/Svelte files; run it locally if you change markup or styles.
- `npm run test:e2e:ci` (Playwright) plus `npm run test:links:ci` ensure cross-browser and link coverage.
- `npm run lighthouse:ci` enforces performance + accessibility budgets before landing a change that touches layout.

## Questions?

Reach out on the repo or cross-post to the church tech/staff email before sending large updates. Thank you!
</file>

<file path="LICENSE">
MIT License

Copyright (c) 2024 First Springfield Church Website contributors

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
</file>

<file path="lighthouserc-ci.cjs">
const baseConfig = require("./web/lighthouserc.cjs");

const config = structuredClone(baseConfig);
config.ci.collect.staticDistDir = "./web/dist";
config.ci.upload = {
  ...config.ci.upload,
  outputDir: "./web/.lighthouseci",
};

module.exports = config;
</file>

<file path="package.json">
{
  "dependencies": {
    "@astrojs/sitemap": "3.6.0"
  }
}
</file>

<file path="SECURITY.md">
# Security Policy

## Reporting a Vulnerability

If you discover a security issue, please notify us at `security@firstspringfieldma.adventistchurch.org` with:

- A short description of the issue.
- The affected component (e.g., frontend embed, deployment).
- Steps to reproduce or a proof of concept.
- Any mitigations you’ve already tried.

We aim to respond within 48 hours, keep the report confidential, and coordinate a fix before public disclosure.

## Supported Versions

This repo runs on the latest dependencies pinned in `web/package-lock.json`. Security updates are applied through CI before merging.

## Guidance for Contributors

- Keep dependencies up to date (`npm update` inside `web/` and rerun `npm run qa`).
- Avoid committing secrets or tokens; use the GitHub secrets store for private configuration.
- Document security implications of large changes in both the PR body and `docs/ui-reliability.md` when relevant.
</file>

<file path="web/src/components/content/ContentCard.astro">
---
export interface Props {
  href: string;
  title: string;
  summary: string;
  meta?: string;
  tags?: string[];
}

const { href, title, summary, meta, tags } = Astro.props;
const safeTags = tags ?? [];
---

<a class="card card--link stack--tight" href={href}>
  {meta && <p class="muted small">{meta}</p>}
  <h3>
    <span class="link">{title}</span>
  </h3>
  <p class="muted">{summary}</p>

  {safeTags.length > 0 && (
    <ul class="tags" aria-label="Tags">
      {safeTags.map((t) => (
        <li class="tag">{t}</li>
      ))}
    </ul>
  )}
</a>

<style>
  .tags {
    list-style: none;
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    padding: 0;
    margin: 0.75rem 0 0;
  }
  .tag {
    font-size: 0.85rem;
    padding: 0.2rem 0.55rem;
    border-radius: 999px;
    border: 1px solid var(--color-border);
    background: color-mix(in oklab, var(--color-surface) 90%, white 10%);
  }
</style>
</file>

<file path="web/src/components/global/Header.astro">
---
import Button from "../ui/Button.astro";
import { site } from "../../data/site";

const pathname = Astro.url?.pathname ?? "/";

function isActive(href: string) {
  if (href === "/") return pathname === "/";
  return pathname === href || pathname.startsWith(href + "/");
}

function linkAttrs(item: { href: string; external?: boolean }) {
  return item.external ? { target: "_blank", rel: "noopener noreferrer" } : {};
}

const watchLive = site.quickActions.find((i) => i.label === "Watch Live") ?? site.quickActions[0];
const give = site.quickActions.find((i) => i.label === "Give") ?? site.quickActions[1];
const otherQuick = site.quickActions.filter((i) => i.label !== watchLive?.label && i.label !== give?.label);
---

<header class="site-header">
  <div class="inner">
    <a class="brand" href="/" aria-label={site.name}>
      <span class="brand__title">{site.shortName}</span>
    </a>

    <nav class="nav nav--desktop" aria-label="Primary navigation">
      {site.nav.map((item) => (
        <a
          href={item.href}
          aria-current={isActive(item.href) ? "page" : undefined}
          {...linkAttrs(item)}
        >
          {item.label}
        </a>
      ))}
    </nav>

    <div class="right">
      <div class="cta cta--desktop" aria-label="Primary actions">
        {watchLive && (
          <Button href={watchLive.href} variant="secondary" size="sm" external={!!watchLive.external}>
            {watchLive.label}
          </Button>
        )}
        {give && (
          <Button href={give.href} variant="primary" size="sm" external={!!give.external}>
            {give.label}
          </Button>
        )}
      </div>

      <div class="cta cta--mobile" aria-label="Primary actions">
        {watchLive && (
          <Button href={watchLive.href} variant="secondary" size="sm" external={!!watchLive.external}>
            {watchLive.label}
          </Button>
        )}
        {give && (
          <Button href={give.href} variant="primary" size="sm" external={!!give.external}>
            {give.label}
          </Button>
        )}
      </div>

      <details class="menu" aria-label="Mobile menu">
        <summary class="menu__summary" aria-label="Open menu">
          <span class="menu__icon" aria-hidden="true">☰</span>
          <span class="menu__label">Menu</span>
        </summary>

        <div class="menu__panel">
          <nav class="menu__section" aria-label="Primary navigation">
            {site.nav.map((item) => (
              <a
                class="menu__link"
                href={item.href}
                aria-current={isActive(item.href) ? "page" : undefined}
                {...linkAttrs(item)}
              >
                {item.label}
              </a>
            ))}
          </nav>

          <div class="menu__divider" role="separator" aria-hidden="true"></div>

          <div class="menu__section" aria-label="Quick actions">
            <div class="menu__actions">
              {watchLive && (
                <Button href={watchLive.href} variant="secondary" size="sm" external={!!watchLive.external}>
                  {watchLive.label}
                </Button>
              )}
              {give && (
                <Button href={give.href} variant="primary" size="sm" external={!!give.external}>
                  {give.label}
                </Button>
              )}
            </div>

            {otherQuick.length > 0 && (
              <div class="menu__quicklinks" aria-label="More quick links">
                {otherQuick.map((item) => (
                  <a class="menu__sublink" href={item.href} {...linkAttrs(item)}>
                    {item.label}
                  </a>
                ))}
              </div>
            )}
          </div>
        </div>
      </details>
    </div>
  </div>
</header>

<script>
  // Close the mobile menu when a link is clicked.
  document.addEventListener("click", (e) => {
    const target = e.target;
    if (!(target instanceof HTMLElement)) return;

    const link = target.closest("a");
    const details = target.closest("details.menu");
    if (link && details) details.removeAttribute("open");
  });
</script>

<style>
  .site-header {
    position: sticky;
    top: 0;
    z-index: 50;
    background: var(--color-white);
    border-bottom: 1px solid var(--color-border);
  }

  .inner {
    max-width: var(--container-max);
    margin: 0 auto;
    padding: var(--space-3) var(--container-pad);
    display: grid;
    grid-template-columns: auto 1fr auto;
    align-items: center;
    gap: var(--space-4);
  }

  .brand {
    text-decoration: none;
    color: inherit;
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    min-width: max-content;
  }

  .brand__title {
    font-weight: 800;
    letter-spacing: -0.02em;
    font-size: var(--font-size-2);
  }

  .nav {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    justify-content: center;
    flex-wrap: wrap;
  }

  .nav a {
    display: inline-flex;
    align-items: center;
    min-height: var(--target-min);
    text-decoration: none;
    color: inherit;
    font-weight: 700;
    opacity: 0.9;
    padding: 0.55rem 0.7rem;
    border-radius: 999px;
  }

  .nav a:hover {
    background: var(--color-gray-50);
    opacity: 1;
  }

  .nav a[aria-current="page"] {
    background: var(--color-gray-100);
    opacity: 1;
  }

  .cta {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    justify-content: flex-end;
    min-width: max-content;
  }

  .right {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: var(--space-2);
    min-width: max-content;
  }

  .cta--mobile {
    display: none;
  }

  /* Mobile menu */
  .menu {
    display: none;
    position: relative;
  }

  .menu__summary {
    list-style: none;
    cursor: pointer;
    user-select: none;
    padding: 0.55rem 0.7rem;
    border-radius: 999px;
    border: 1px solid var(--color-border);
    background: var(--color-white);
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    font-weight: 700;
    min-height: var(--target-min);
  }

  .menu__summary::-webkit-details-marker {
    display: none;
  }

  .menu[open] .menu__summary {
    background: var(--color-gray-50);
  }

  .menu__panel {
    position: absolute;
    right: 0;
    top: calc(100% + 0.6rem);
    width: min(92vw, 22rem);
    background: var(--color-white);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-3);
    box-shadow: var(--shadow-2);
    padding: var(--space-3);
    z-index: 60;
  }

  .menu__section {
    display: grid;
    gap: 0.35rem;
  }

  .menu__link {
    display: flex;
    align-items: center;
    min-height: var(--target-min);
    text-decoration: none;
    color: inherit;
    font-weight: 700;
    padding: 0.6rem 0.7rem;
    border-radius: var(--radius-2);
  }

  .menu__link:hover {
    background: var(--color-gray-50);
  }

  .menu__link[aria-current="page"] {
    background: var(--color-gray-100);
  }

  .menu__divider {
    height: 1px;
    background: var(--color-border);
    margin: var(--space-3) 0;
  }

  .menu__actions {
    display: flex;
    gap: var(--space-2);
    flex-wrap: wrap;
  }

  .menu__quicklinks {
    margin-top: var(--space-3);
    display: grid;
    gap: 0.25rem;
  }

  .menu__sublink {
    display: inline-flex;
    align-items: center;
    min-height: var(--target-min);
    text-decoration: none;
    color: inherit;
    opacity: 0.9;
    padding: 0.4rem 0.2rem;
    font-weight: 700;
  }

  .menu__sublink:hover {
    opacity: 1;
    text-decoration: underline;
  }

  @media (max-width: 860px) {
    .nav--desktop,
    .cta--desktop {
      display: none;
    }

    .cta--mobile {
      display: flex;
    }

    .inner {
      grid-template-columns: auto 1fr auto;
    }

    .menu {
      display: block;
    }
  }

  @media (max-width: 420px) {
    .menu__label {
      display: none;
    }

    .menu__summary {
      padding: 0.55rem 0.6rem;
    }
  }
</style>
</file>

<file path="web/src/components/media/YouTubeEmbed.astro">
---
type Props = {
  title: string;
  /** Full YouTube embed URL, e.g. https://www.youtube.com/embed/VIDEO_ID */
  embedUrl: string;
};

const { title, embedUrl } = Astro.props;
---

<div class="yt" aria-label={title}>
  <iframe
    class="yt__frame"
    src={embedUrl}
    title={title}
    loading="lazy"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
    referrerpolicy="strict-origin-when-cross-origin"
    allowfullscreen
  ></iframe>
</div>

<style>
  .yt {
    position: relative;
    width: 100%;
    border-radius: var(--radius-3);
    overflow: hidden;
    border: 1px solid var(--color-border);
    background: var(--color-surface-2);
  }

  /* 16:9 */
  .yt::before {
    content: "";
    display: block;
    padding-top: 56.25%;
  }

  .yt__frame {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    border: 0;
  }
</style>
</file>

<file path="web/src/components/sections/CardGrid.astro">
---
import Card from "../ui/Card.astro";
import Grid from "../ui/CardGrid.astro";

type CardItem = {
  title: string;
  description?: string;
  href?: string;
};

type Props = {
  title?: string;
  subtitle?: string;
  cards: CardItem[];
  columns?: number;
  columnsMin?: number;
};

const { title, subtitle, cards, columns, columnsMin = 240 } = Astro.props;
---

<section class="stack">
  {(title || subtitle) && (
    <header class="stack--tight">
      {title && <h2>{title}</h2>}
      {subtitle && <p class="muted">{subtitle}</p>}
    </header>
  )}

  <Grid columns={columns} columnsMin={columnsMin}>
    {cards.map((c) => (
      <Card title={c.title} description={c.description} href={c.href} />
    ))}
  </Grid>
</section>
</file>

<file path="web/src/components/sections/EventList.astro">
---
import ContentCard from "../content/ContentCard.astro";
import { getCollection } from "astro:content";
import { site } from "../../data/site";

type Props = {
  title?: string;
  limit?: number;
  showViewAll?: boolean;
};

const { title = "Upcoming Events", limit = 3, showViewAll = true } = Astro.props;

const events = await getCollection("events", ({ data }) =>
  import.meta.env.PROD ? data.draft !== true : true
);

const now = new Date();
const upcoming = events
  .filter((e) => e.data.start >= now)
  .sort((a, b) => a.data.start.valueOf() - b.data.start.valueOf())
  .slice(0, limit);

const fmt = new Intl.DateTimeFormat(site.locale, {
  dateStyle: "medium",
  timeStyle: "short",
  timeZone: site.timeZone
});
---

<section class="stack">
  <div class="cluster cluster--between cluster--baseline cluster--loose">
    <h2>{title}</h2>
    {showViewAll && (
      <a class="link" href="/events">
        View all
      </a>
    )}
  </div>

  {upcoming.length === 0 ? (
    <p class="muted">No upcoming events are published yet.</p>
  ) : (
    <div class="grid--cards">
      {upcoming.map((e) => (
        <ContentCard
          href={`/events/${e.id}`}
          title={e.data.title}
          summary={e.data.summary}
          meta={fmt.format(e.data.start)}
          tags={e.data.tags}
        />
      ))}
    </div>
  )}
</section>
</file>

<file path="web/src/components/sections/HeroBanner.astro">
---
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";
import HeroUI from "../ui/Hero.astro";

export type Props = {
  title: string;
  subtitle?: string;
  primaryCtaLabel?: string;
  primaryCtaHref?: string;
  secondaryCtaLabel?: string;
  secondaryCtaHref?: string;

  background: ImageMetadata;

  /**
   * Keep the bridge centered-ish.
   * Example: "50% 55%" (x y)
   */
  objectPosition?: string;
};

const {
  background,
  objectPosition = "50% 55%",
  ...heroProps
} = Astro.props as Props;
---

<section class="heroBanner fullbleed" style={`--hero-object-position:${objectPosition};`}>
  <div class="heroBanner__media" aria-hidden="true">
    <Image
      src={background}
      alt=""
      widths={[640, 960, 1280, 1600, 1920]}
      sizes="100vw"
      loading="eager"
      decoding="async"
      fetchpriority="high"
      class="heroBanner__img"
    />
    <div class="heroBanner__scrim" aria-hidden="true"></div>
  </div>

  <div class="heroBanner__content">
    <div class="heroBanner__container">
      <HeroUI {...heroProps} />
    </div>
  </div>
</section>

<style>
  .heroBanner {
    position: relative;
    padding: var(--space-12) 0;
    border-bottom: 1px solid var(--color-border);
    overflow: hidden;
  }

  .heroBanner__media {
    position: absolute;
    inset: 0;
  }

  .heroBanner__img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: var(--hero-object-position);
    transform: scale(1.02);
  }

  .heroBanner__scrim {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      180deg,
      rgba(11, 15, 23, 0.45) 0%,
      rgba(11, 15, 23, 0.18) 45%,
      rgba(11, 15, 23, 0.55) 100%
    );
  }

  .heroBanner__content {
    position: relative;
    z-index: 1;
  }

  /* Match BaseLayout container sizing without nesting issues */
  .heroBanner__container {
    width: min(var(--container-max), calc(100% - var(--container-pad)));
    margin: 0 auto;
  }

  /* Keep the existing “card” look, but make it sit nicely on the photo */
  :global(.heroBanner .hero.card) {
    background: rgba(255, 255, 255, 0.90);
    backdrop-filter: blur(10px);
    border-color: rgba(255, 255, 255, 0.35);
  }

  @media (max-width: 720px) {
    .heroBanner {
      padding: var(--space-8) 0;
    }
    /* Slightly higher crop on mobile so the bridge line stays visible */
    .heroBanner {
      --hero-object-position: 50% 50%;
    }
  }

  @media (prefers-reduced-data: reduce) {
    .heroBanner__media {
      display: none;
    }
    .heroBanner {
      background: var(--color-surface-2);
    }
  }
</style>
</file>

<file path="web/src/components/sections/SermonHighlight.astro">
---
import Button from "../ui/Button.astro";
import YouTubeEmbed from "../media/YouTubeEmbed.astro";
import videos from "../../data/videos.json";
import { site } from "../../data/site";

type Video = {
  title: string;
  date: string;
  youtubeId?: string;
  summary?: string;
};

type Props = {
  title?: string;
};

const { title = "Latest Sermon" } = Astro.props;

const list = (videos as Video[]).slice().sort((a, b) => {
  return new Date(b.date).valueOf() - new Date(a.date).valueOf();
});

const latest = list[0];
const hasEmbed = latest && latest.youtubeId && latest.youtubeId !== "TBD";
const hasYouTube = Boolean(site.portals.youtubeChannelUrl && site.portals.youtubeChannelUrl !== "TBD");

const fmt = new Intl.DateTimeFormat(site.locale, {
  dateStyle: "medium",
  timeZone: site.timeZone
});
const meta = latest?.date ? fmt.format(new Date(latest.date)) : undefined;
const youtubeHref = hasYouTube ? site.portals.youtubeChannelUrl : "/media/videos";
---

<section class="stack">
  <h2>{title}</h2>

  {!latest ? (
    <p class="muted">No videos are listed yet.</p>
  ) : (
    <div class="card stack">
      <div class="stack--tight">
        {meta && <p class="muted small">{meta}</p>}
        <h3>{latest.title}</h3>
        {latest.summary && <p class="muted">{latest.summary}</p>}
      </div>

      {hasEmbed ? (
        <YouTubeEmbed
          title={latest.title}
          embedUrl={`https://www.youtube.com/embed/${latest.youtubeId}`}
        />
      ) : (
        <p class="small muted">
          New sermon video coming soon. Check back soon or browse the video archive.
        </p>
      )}

      <div class="cluster">
        <Button href="/media/videos" variant="secondary">More videos</Button>
        {hasYouTube ? (
          <Button href={youtubeHref} external>Open YouTube</Button>
        ) : null}
      </div>
    </div>
  )}
</section>
</file>

<file path="web/src/components/ui/CardGrid.astro">
---
type Props = {
  /** Fixed number of columns (e.g. 3). */
  columns?: number;
  /** Responsive min column width in px (auto-fit). */
  columnsMin?: number;
};

const { columns, columnsMin = 240 } = Astro.props;

const template =
  typeof columns === "number"
    ? `repeat(${columns}, minmax(0, 1fr))`
    : `repeat(auto-fit, minmax(${columnsMin}px, 1fr))`;
---

<div class="grid" style={`grid-template-columns: ${template};`}>
  <slot />
</div>

<style>
  .grid {
    display: grid;
    gap: var(--space-4);
  }
</style>
</file>

<file path="web/src/components/ui/Hero.astro">
---
import Button from "./Button.astro";

type Props = {
  title: string;
  subtitle?: string;
  primaryCtaLabel?: string;
  primaryCtaHref?: string;
  secondaryCtaLabel?: string;
  secondaryCtaHref?: string;
};

const {
  title,
  subtitle,
  primaryCtaLabel,
  primaryCtaHref,
  secondaryCtaLabel,
  secondaryCtaHref
} = Astro.props;
---

<section class="hero card">
  <div class="hero__inner">
    <div>
      <h1 class="hero__title">{title}</h1>
      {subtitle && <p class="hero__subtitle muted">{subtitle}</p>}
    </div>

    {(primaryCtaLabel && primaryCtaHref) || (secondaryCtaLabel && secondaryCtaHref) ? (
      <div class="hero__actions">
        {primaryCtaLabel && primaryCtaHref && (
          <Button href={primaryCtaHref} variant="primary">{primaryCtaLabel}</Button>
        )}
        {secondaryCtaLabel && secondaryCtaHref && (
          <Button href={secondaryCtaHref} variant="secondary">{secondaryCtaLabel}</Button>
        )}
      </div>
    ) : null}
  </div>
</section>

<style>
  .hero__inner {
    display: grid;
    gap: var(--space-4);
  }

  .hero__title {
    margin: 0;
    font-size: clamp(2.4rem, 1.8rem + 2.8vw, 3.5rem);
    line-height: 1.15;
  }

  .hero__subtitle {
    margin: var(--space-2) 0 0;
    font-size: clamp(1.05rem, 0.95rem + 0.7vw, 1.4rem);
  }

  .hero__actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
  }
</style>
</file>

<file path="web/src/components/ui/Schedule.astro">
---
import type { ScheduleItem } from "../../data/site";

type Props = {
  title?: string;
  items: ScheduleItem[];
};

const { title = "This Week", items } = Astro.props;
---

<section class="card stack--tight">
  <h2>{title}</h2>
  <ul class="schedule">
    {items.map((item) => (
      <li class="schedule__item">
        <div class="schedule__label">{item.label}</div>
        <div class="schedule__meta muted">{item.day} - {item.time}</div>
      </li>
    ))}
  </ul>
</section>

<style>
  .schedule {
    list-style: none;
    margin: 0;
    padding: 0;
    display: grid;
    gap: var(--space-3);
  }

  .schedule__item {
    padding: var(--space-3);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-3);
    background: var(--color-surface-muted);
  }

  .schedule__label {
    font-weight: 800;
  }

  .schedule__meta {
    font-size: var(--font-size-0);
    margin-top: var(--space-1);
  }
</style>
</file>

<file path="web/src/components/PlaceholderPage.astro">
---
type Props = {
  title: string;
  message?: string;
};

const { title, message } = Astro.props;
---

<section class="card stack--tight">
  <h1>{title}</h1>
  <p class="muted">
    {message ?? "We’re preparing this page. More information will be here soon."}
  </p>
</section>
</file>

<file path="web/src/content/resources/2025/12/16/welcome-packet.md">
---
title: "Welcome Packet"
summary: "A quick overview of our church, what we believe, and how to get connected."
published: "2025-12-16"
category: "New Here"
attachmentUrl: "/resources/forms" # replace with a real PDF path if/when you add one
---

## Inside

- Service times
- What to expect
- Ways to connect
</file>

<file path="web/src/data/week-schedule.json">
[
  { "label": "Sabbath School", "day": "Saturday", "time": "10:00 AM" },
  { "label": "Worship Service", "day": "Saturday", "time": "11:15 AM" },
  { "label": "Prayer Meeting", "day": "Wednesday", "time": "7:00 PM" }
]
</file>

<file path="web/src/lib/links.ts">
export function mailto(email: string, subject?: string) {
  const e = (email ?? "").trim();
  if (!e) return "";
  const params = subject ? `?subject=${encodeURIComponent(subject)}` : "";
  return `mailto:${e}${params}`;
}

export function tel(phone: string) {
  const p = (phone ?? "").trim();
  if (!p) return "";
  const digits = p.replace(/[^0-9+]/g, "");
  return digits ? `tel:${digits}` : "";
}
</file>

<file path="web/src/pages/connect/team/index.astro">
---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { site } from "../../../data/site";
import { mailto } from "../../../lib/links";
export const prerender = false;

const isFilled = (value?: string) => Boolean(value && value.trim() && value !== "TBD");
const fallbackName = "Contact us";
const fallbackHref = "/connect/contact";
const fallbackLabel = "Contact us for current details.";
---

<BaseLayout title="Our Team" description={`Meet the leadership and ministry contacts at ${site.name}.`}>
  <div class="stack">
    <h1>Our Team</h1>

    <section class="card stack">
      <h2>Leadership</h2>
      <p class="muted">
        For most questions, starting with the Pastor or Head Elder is a great first step.
      </p>

      <div class="table">
        <div class="row head">
          <div>Role</div>
          <div>Name</div>
          <div>Contact</div>
        </div>

        {(site.leadershipTeam ?? []).map((m) => {
          const name = isFilled(m.name) ? m.name : fallbackName;
          const email = isFilled(m.email) ? m.email : "";

          return (
            <div class="row">
              <div>{m.role}</div>
              <div>{name}</div>
              <div>
                {email ? (
                  <a href={mailto(email, `${m.role} - ${site.shortName}`)}>{email}</a>
                ) : (
                  <a class="link" href={fallbackHref}>{fallbackLabel}</a>
                )}
              </div>
            </div>
          );
        })}
      </div>
    </section>

    <section class="card stack">
      <h2>Ministry Leads</h2>
      <p class="muted">
        Reach out to the ministry lead closest to your question, or use the general email if you’re not sure.
      </p>

      <div class="table">
        <div class="row head">
          <div>Ministry</div>
          <div>Name</div>
          <div>Contact</div>
        </div>

        {(site.ministryLeads ?? []).map((m) => {
          const name = isFilled(m.name) ? m.name : fallbackName;
          const email = isFilled(m.email) ? m.email : "";

          return (
            <div class="row">
              <div>{m.role}</div>
              <div>{name}</div>
              <div>
                {email ? (
                  <a href={mailto(email, `${m.role} - ${site.shortName}`)}>{email}</a>
                ) : (
                  <a class="link" href={fallbackHref}>{fallbackLabel}</a>
                )}
              </div>
            </div>
          );
        })}
      </div>
    </section>

    <section class="card stack">
      <h2>Who to contact for what</h2>
      <p class="muted">
        Not sure who to reach? Start with one of these.
      </p>

      <div class="table">
        <div class="row head">
          <div>Topic</div>
          <div>Contact</div>
          <div>How</div>
        </div>

        {(site.contactTopics ?? []).map((t) => {
          const topicHref = isFilled(t.href) ? t.href : "";
          const topicEmail = isFilled(t.email) ? t.email : "";

          return (
            <div class="row">
              <div>{t.topic}</div>
              <div>{t.contactRole}</div>
              <div class="stack--tight">
                {topicHref ? (
                  <a
                    href={topicHref}
                    target={t.external ? "_blank" : undefined}
                    rel={t.external ? "noopener noreferrer" : undefined}
                  >
                    {t.hrefLabel ?? "Open"}
                  </a>
                ) : topicEmail ? (
                  <a href={mailto(topicEmail, `${t.topic} - ${site.shortName}`)}>{topicEmail}</a>
                ) : (
                  <a class="link" href={fallbackHref}>{fallbackLabel}</a>
                )}
                {t.note ? <div class="small muted">{t.note}</div> : null}
              </div>
            </div>
          );
        })}
      </div>
    </section>
  </div>
</BaseLayout>

<style>
  .table {
    border: 1px solid var(--color-border);
    border-radius: var(--radius-2);
    overflow: hidden;
  }

  .row {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: var(--space-4);
    padding: var(--space-3) var(--space-4);
    border-top: 1px solid var(--color-border);
    background: var(--color-white);
  }

  .row.head {
    border-top: none;
    background: var(--color-bg);
    font-weight: 800;
  }

  .muted {
    color: var(--color-text-muted);
  }

  .small {
    font-size: 0.95rem;
  }

  @media (max-width: 720px) {
    .row {
      grid-template-columns: 1fr;
      gap: var(--space-2);
    }
  }
</style>
</file>

<file path="web/src/pages/events/[id].astro">
---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Hero from '../../components/ui/Hero.astro';
import { getCollection, render } from 'astro:content';
import { site } from '../../data/site';

export async function getStaticPaths() {
  const events = await getCollection('events', ({ data }) => {
    return import.meta.env.PROD ? data.draft !== true : true;
  });

  return events.map((event) => ({
    params: { id: event.id },
    props: { event },
  }));
}

const { event } = Astro.props;
const { Content } = await render(event);

const fmtDate = new Intl.DateTimeFormat(site.locale, {
  dateStyle: 'full',
  timeStyle: 'short',
  timeZone: site.timeZone,
});

const locationName = event.data.locationName ?? "";
const address =
  event.data.address ?? (locationName === site.name ? site.contact.address : "");

const when = event.data.end
  ? `${fmtDate.format(event.data.start)} – ${fmtDate.format(event.data.end)}`
  : fmtDate.format(event.data.start);
---

<BaseLayout title={event.data.title} description={event.data.summary}>
  <Hero title={event.data.title} subtitle={event.data.summary} />

  <section class="stack">
    <div class="card stack--tight">
      <p class="muted"><strong>When:</strong> {when}</p>
      {locationName && (
        <p class="muted"><strong>Where:</strong> {locationName}</p>
      )}
      {address && (
        <p class="muted"><strong>Address:</strong> {address}</p>
      )}
      {event.data.registrationUrl && (
        <p>
          <a class="link" href={event.data.registrationUrl} rel="noopener noreferrer">Register / Learn more</a>
        </p>
      )}
    </div>

    <article class="card">
      <div class="prose">
        <Content />
      </div>
    </article>

    <p><a class="link" href="/events">← Back to Events</a></p>
  </section>
</BaseLayout>
</file>

<file path="web/src/pages/events/index.astro">
---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Hero from '../../components/ui/Hero.astro';
import ContentCard from '../../components/content/ContentCard.astro';
import RecurringActivities from '../../components/sections/RecurringActivities.astro';
import { getCollection } from 'astro:content';
import { site } from '../../data/site';

const events = await getCollection('events', ({ data }) => {
  return import.meta.env.PROD ? data.draft !== true : true;
});

const now = new Date();
const upcoming = events
  .filter((e) => e.data.start >= now)
  .sort((a, b) => a.data.start.valueOf() - b.data.start.valueOf());

const past = events
  .filter((e) => e.data.start < now)
  .sort((a, b) => b.data.start.valueOf() - a.data.start.valueOf())
  .slice(0, 12);

const fmt = new Intl.DateTimeFormat(site.locale, {
  dateStyle: 'medium',
  timeStyle: 'short',
  timeZone: site.timeZone,
});
---

<BaseLayout title="Events" description="What’s happening at church.">
  <Hero
    title="Events"
    subtitle="See what’s coming up and what we’ve recently hosted."
  />

  <section class="stack--loose">
    <RecurringActivities />

    <div class="stack">
      <h2>Upcoming</h2>

      {upcoming.length === 0 ? (
        <p class="muted">No upcoming events are published yet.</p>
      ) : (
        <div class="grid--cards">
          {upcoming.map((e) => (
            <ContentCard
              href={`/events/${e.id}`}
              title={e.data.title}
              summary={e.data.summary}
              meta={fmt.format(e.data.start)}
              tags={e.data.tags}
            />
          ))}
        </div>
      )}
    </div>

    <div class="stack">
      <h2>Recent</h2>
      {past.length === 0 ? (
        <p class="muted">No past events are published yet.</p>
      ) : (
        <div class="grid--cards">
          {past.map((e) => (
            <ContentCard
              href={`/events/${e.id}`}
              title={e.data.title}
              summary={e.data.summary}
              meta={fmt.format(e.data.start)}
              tags={e.data.tags}
            />
          ))}
        </div>
      )}
    </div>
  </section>
</BaseLayout>
</file>

<file path="web/src/pages/privacy/index.astro">
---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Hero from "../../components/ui/Hero.astro";

const analyticsEnabled = import.meta.env.PROD && Boolean(import.meta.env.PUBLIC_CF_ANALYTICS_TOKEN);
---

<BaseLayout title="Privacy" description="Privacy and data use">
  <div class="stack">
    <Hero title="Privacy" subtitle="How this website handles data." />

    <section class="card stack">
      <h2>Analytics</h2>
      {analyticsEnabled ? (
        <>
          <p class="muted">
            This site uses Cloudflare Web Analytics to understand overall traffic (for example: page views and referrers).
            We use this information to improve content and navigation.
          </p>
          <ul class="muted">
            <li>We measure aggregated traffic, not individual user behavior.</li>
            <li>We do not sell personal information.</li>
            <li>We do not use this analytics setup for ad targeting.</li>
          </ul>
        </>
      ) : (
        <p class="muted">
          This site currently has analytics disabled. If enabled in the future, this page will be updated.
        </p>
      )}

      <h2>Search</h2>
      <p class="muted">
        Search is powered by a static index and runs in your browser. Search queries are not sent to a server.
      </p>

      <h2>External links</h2>
      <p class="muted">
        Some buttons and links may send you to external platforms (for example: online giving, YouTube, or forms).
        Those services have their own privacy policies.
      </p>

      <h2>Contact</h2>
      <p class="muted">
        If you have privacy questions, please contact the church.
      </p>
    </section>
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/resources/[...id].astro">
---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Hero from '../../components/ui/Hero.astro';
import { getCollection, render } from 'astro:content';
import { site } from '../../data/site';

export async function getStaticPaths() {
  const resources = await getCollection('resources', ({ data }) => {
    return import.meta.env.PROD ? data.draft !== true : true;
  });

  return resources.map((resource) => ({
    params: { id: resource.id },
    props: { resource },
  }));
}

const { resource } = Astro.props;
const { Content } = await render(resource);

const fmt = new Intl.DateTimeFormat(site.locale, {
  dateStyle: 'full',
  timeZone: site.timeZone,
});
---

<BaseLayout title={resource.data.title} description={resource.data.summary}>
  <Hero title={resource.data.title} subtitle={resource.data.summary} />

  <section class="stack">
    <div class="card stack--tight">
      <p class="muted"><strong>Published:</strong> {fmt.format(resource.data.published)}</p>
      {resource.data.category && (
        <p class="muted"><strong>Category:</strong> {resource.data.category}</p>
      )}

      {resource.data.attachmentUrl && (
        <p>
          <a class="link" href={resource.data.attachmentUrl}>Download / Open attachment</a>
        </p>
      )}

      {resource.data.externalUrl && (
        <p>
          <a class="link" href={resource.data.externalUrl} rel="noopener noreferrer">Open external link</a>
        </p>
      )}
    </div>

    <article class="card">
      <div class="prose">
        <Content />
      </div>
    </article>

    <p><a class="link" href="/resources">← Back to Resources</a></p>
  </section>
</BaseLayout>
</file>

<file path="web/src/styles/a11y.css">
/* Small accessibility helpers layered on top of global.css */

:focus-visible {
  outline: 3px solid var(--color-focus);
  outline-offset: 3px;
}

/* If skip-link isn't already styled in global.css, this ensures it is usable */
.skip-link {
  position: absolute;
  top: var(--space-2);
  left: var(--space-2);
  padding: var(--space-2) var(--space-3);
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-2);
  text-decoration: none;
  transform: translateY(-200%);
  transition: transform 120ms ease;
  z-index: 999;
}

.skip-link:focus {
  transform: translateY(0);
}

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
</file>

<file path="web/tests/e2e/content-collections.spec.ts">
import { expect, test } from '@playwright/test';

test('Events hub loads', async ({ page }) => {
  await page.goto('/events');
  await expect(page.getByRole('heading', { name: 'Events' })).toBeVisible();
});

test('Ministries hub loads', async ({ page }) => {
  await page.goto('/ministries');
  await expect(page.getByRole('heading', { name: 'Ministries' })).toBeVisible();
});

test('Resources hub loads', async ({ page }) => {
  await page.goto('/resources');
  await expect(page.getByRole('heading', { name: 'Resources', exact: true })).toBeVisible();
});
</file>

<file path="web/tests/e2e/phase-5-media-portals.spec.ts">
import { expect, test } from "@playwright/test";

test("Media hub loads", async ({ page }) => {
  await page.goto("/media");
  await expect(page.getByRole("heading", { name: "Media", exact: true })).toBeVisible();

  const quickLinks = page.getByRole("region", { name: "Quick links" });
  await expect(quickLinks.getByRole("link", { name: "Watch Live", exact: true })).toBeVisible();
  await expect(quickLinks.getByRole("link", { name: "Videos", exact: true })).toBeVisible();
});

test("Live page loads", async ({ page }) => {
  await page.goto("/media/live");
  await expect(page.getByRole("heading", { name: "Watch Live", exact: true })).toBeVisible();
  await expect(page.getByRole("link", { name: "Open YouTube channel", exact: true })).toBeVisible();
});

test("Videos page loads", async ({ page }) => {
  await page.goto("/media/videos");
  await expect(page.getByRole("heading", { name: "Videos", exact: true })).toBeVisible();
  await expect(page.getByRole("link", { name: "Browse on YouTube", exact: true })).toBeVisible();
});

test("Bulletins page loads", async ({ page }) => {
  await page.goto("/resources/bulletins");
  await expect(page.getByRole("heading", { name: "Bulletins", exact: true })).toBeVisible();
});

test("Forms directory loads", async ({ page }) => {
  await page.goto("/resources/forms");
  await expect(page.getByRole("heading", { name: "Forms", exact: true })).toBeVisible();
});
</file>

<file path="web/tests/e2e/phase-6-search-and-analytics.spec.ts">
import { expect, test } from "playwright/test";

test("Search page loads", async ({ page }) => {
  await page.goto("/search");
  await expect(page.getByRole("heading", { name: "Search", exact: true })).toBeVisible();

  // Astro Pagefind <Search id="site-search" ... /> should render an input inside this container.
  const input = page.locator("#site-search input");
  await expect(input).toBeVisible({ timeout: 10_000 });
});

test("Search returns results for a common term", async ({ page }) => {
  // This test is intentionally loose to reduce flakiness.
  // It just verifies that results can render.
  await page.goto("/search");

  const input = page.locator("#site-search input");
  await expect(input).toBeVisible({ timeout: 10_000 });

  await input.fill("resources");

  // Pagefind UI renders results asynchronously.
  // Wait for at least one result link to appear inside the Pagefind root.
  const firstResultLink = page.locator("#site-search a[href]").first();
  await expect(firstResultLink).toBeVisible({ timeout: 10_000 });
});
</file>

<file path="web/tests/e2e/phase-7-seo.spec.ts">
import { expect, test } from "@playwright/test";

const PAGES: Array<{ path: string; robots: string }> = [
  { path: "/", robots: "index,follow" },
  { path: "/connect/plan-a-visit", robots: "index,follow" },
  { path: "/connect/team", robots: "index,follow" },
  { path: "/events", robots: "index,follow" },
  { path: "/resources", robots: "index,follow" },
  { path: "/media", robots: "index,follow" },
  { path: "/search", robots: "noindex,follow" }
];

for (const { path, robots } of PAGES) {
  test(`seo meta - ${path}`, async ({ page }) => {
    await page.goto(path);

    await expect(page).toHaveTitle(/.+/);

    await expect(page.locator('meta[name="description"]'))
      .toHaveAttribute("content", /.+/);

    const canonical = page.locator('link[rel="canonical"]');
    const canonicalHref = await canonical.getAttribute("href");
    expect(canonicalHref).toBeTruthy();
    expect(canonicalHref!).toContain(path);

    await expect(page.locator('meta[property="og:title"]'))
      .toHaveAttribute("content", /.+/);

    await expect(page.locator('meta[name="robots"]'))
      .toHaveAttribute("content", robots);
  });
}
</file>

<file path="web/.env.example">
# Future use (Phase 5+)
# PUBLIC_SITE_URL=https://example.com
PUBLIC_CF_ANALYTICS_TOKEN=
</file>

<file path="web/tsconfig.json">
{
  "extends": "astro/tsconfigs/strict",
  "compilerOptions": {
    "resolveJsonModule": true
  },
  "include": [".astro/types.d.ts", "**/*"],
  "exclude": ["dist"]
}
</file>

<file path="docs/phase-0/source-of-truth.yml">
church:
  public_name: "First Springfield Seventh-day Adventist Church"
  address:
    street: "1118 Sumner Ave"
    city: "Springfield"
    state: "MA"
    zip: "01118-2154"
  phone: "(413) 782-6260"
  pastor_cell: "(240) 850-9452"
  email_public: "firstspringfieldsda@gmail.com"
  languages:
    primary: "English"

schedule:
  sabbath_school:
    day: "Saturday"
    time: "10:00 AM"
  worship_service:
    day: "Saturday"
    time: "11:15 AM"
  prayer_meeting:
    day: "Wednesday"
    time: "7:00 PM"

portals:
  giving_url: "https://adventistgiving.org/"
  youtube_channel_url: "https://www.youtube.com/@1stspringfieldsdama74"
  facebook_url: "TBD"
  prayer_form_url: "TBD"
  contact_form_url: "TBD"
  volunteer_form_url: "TBD"
  official_site_url: "https://firstspringfieldma.adventistchurch.org/"

copy:
  homepage_tagline: "A Christian community in Springfield, MA"
  welcome_message: "We would love to have you join our church family."
</file>

<file path="web/src/components/global/Footer.astro">
---
import { site } from "../../data/site";
import { tel } from "../../lib/links";

const year = new Date().getFullYear();
const churchPhoneHref = tel(site.contact.phone);
const pastorCellHref = tel(site.contact.pastorCell);
const pastorCellLabel = site.contact.pastorCellLabel ?? "Pastor Kobe (call/text)";
const hasPastorCell = Boolean(site.contact.pastorCell && site.contact.pastorCell.trim());
const hasMailing = Boolean(site.contact.mailingAddress && site.contact.mailingAddress.trim().length);
const hasFacebook = Boolean(site.portals.facebookUrl && site.portals.facebookUrl !== "TBD");
const hasYouTube = Boolean(site.portals.youtubeChannelUrl && site.portals.youtubeChannelUrl !== "TBD");

function linkAttrs(item: { href: string; external?: boolean }) {
  return item.external ? { target: "_blank", rel: "noopener noreferrer" } : {};
}

const primaryNavLabels = ["Visit", "Contact"];
const primaryActionLabels = ["Watch Live", "Give"];

const isDefined = <T,>(value: T | undefined | null): value is T => Boolean(value);

const findNav = (label: string) => site.nav.find((item) => item.label === label);
const findAction = (label: string) => site.quickActions.find((item) => item.label === label);

const primaryLinks = [
  findNav("Visit"),
  findNav("Contact"),
  findAction("Watch Live"),
  findAction("Give")
].filter(isDefined);

const secondaryNav = site.nav.filter((item) => !primaryNavLabels.includes(item.label));
const secondaryActions = site.quickActions.filter((item) => !primaryActionLabels.includes(item.label));
---

<footer class="site-footer">
  <div class="inner">
    <div class="left">
      <strong>{site.name}</strong>

      <div class="muted">
        <a href={site.contact.mapsUrl} target="_blank" rel="noopener noreferrer">
          {site.contact.address}
        </a>
      </div>

      {hasMailing ? (
        <div class="muted small">
          Mail: {site.contact.mailingAddress}
        </div>
      ) : null}

      <div class="muted footer-contact">
        {hasPastorCell ? (
          <div>
            <span class="footer-contact-label">{pastorCellLabel}:</span>
            <a href={pastorCellHref}>{site.contact.pastorCell}</a>
          </div>
        ) : null}
        <div>
          <span class="footer-contact-label">Church:</span>
          <a href={churchPhoneHref}>{site.contact.phone}</a>
        </div>
        <div>
          <a href={`mailto:${site.contact.email}`}>{site.contact.email}</a>
        </div>
      </div>

      <div class="muted small">© {year}</div>
    </div>

    <nav class="right" aria-label="Footer links">
      <div class="col col--primary">
        <div class="col-title">Start here</div>
        <div class="col-body links">
          {primaryLinks.map((item) => (
            <a href={item.href} {...linkAttrs(item)}>
              {item.label}
            </a>
          ))}
        </div>
      </div>

      <div class="col">
        <div class="col-title">Explore</div>
        <div class="col-body links">
          {secondaryNav.map((item) => (
            <a href={item.href} {...linkAttrs(item)}>
              {item.label}
            </a>
          ))}
        </div>
      </div>

      <div class="col">
        <div class="col-title">Quick actions</div>
        <div class="col-body links">
          {secondaryActions.map((item) => (
            <a href={item.href} {...linkAttrs(item)}>
              {item.label}
            </a>
          ))}
          {hasYouTube ? (
            <a href={site.portals.youtubeChannelUrl} target="_blank" rel="noopener noreferrer">
              YouTube
            </a>
          ) : null}
          {hasFacebook ? (
            <a href={site.portals.facebookUrl} target="_blank" rel="noopener noreferrer">
              Facebook
            </a>
          ) : null}
        </div>
      </div>

      <div class="col">
        <div class="col-title">Service times</div>
        <div class="col-body muted small">
          {site.schedule.map((s) => (
            <div class="line">
              <span class="day">{s.day}</span>
              <span aria-hidden="true"> · </span>
              <span class="time">{s.time}</span>
              <span aria-hidden="true"> — </span>
              <span class="label">{s.label}</span>
            </div>
          ))}
        </div>
      </div>

    </nav>
  </div>
</footer>

<style>
  .site-footer {
    border-top: 1px solid var(--color-border);
    background: var(--color-white);
  }

  .inner {
    max-width: var(--container-max);
    margin: 0 auto;
    padding: var(--space-6) var(--container-pad);
    display: flex;
    gap: var(--space-6);
    justify-content: space-between;
    flex-wrap: wrap;
    align-items: flex-start;
  }

  .muted {
    color: var(--color-text-muted);
    margin-top: var(--space-2);
  }

  .footer-contact {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
    margin-top: var(--space-2);
  }

  .footer-contact-label {
    font-weight: 600;
    margin-right: 0.35rem;
  }

  .small {
    font-size: 0.95rem;
  }

  .left a {
    color: inherit;
  }

  .right {
    display: flex;
    gap: var(--space-6);
    flex-wrap: wrap;
    align-items: flex-start;
  }

  .col {
    min-width: 190px;
    display: grid;
    gap: var(--space-2);
  }

  .col-title {
    font-weight: 800;
    letter-spacing: -0.01em;
  }

  .col--primary .col-title {
    color: var(--color-text);
  }

  .col-body {
    display: grid;
    gap: var(--space-2);
  }

  .line .day,
  .line .time,
  .line .label {
    white-space: nowrap;
  }

  .links a {
    display: inline-flex;
    align-items: center;
    min-height: var(--target-min);
    padding: 0.2rem 0;
    text-decoration: none;
    color: inherit;
    opacity: 0.9;
    font-weight: 600;
  }

  .links a:hover {
    opacity: 1;
    text-decoration: underline;
  }

  @media (max-width: 520px) {
    .col {
      min-width: 100%;
    }
  }
</style>
</file>

<file path="web/src/components/ui/Banner.astro">
---
import Button from "./Button.astro";

type BannerTone = "info" | "warn";

type Props = {
  message: string;
  ctaLabel?: string;
  ctaHref?: string;
  tone?: BannerTone;
};

const {
  message,
  ctaLabel,
  ctaHref,
  tone = "info"
} = Astro.props as Props;

const toneClass = tone === "warn" ? "banner--warn" : "banner--info";
---

<section class={`banner ${toneClass}`} role="status">
  <div class="banner__inner">
    <div class="banner__msg">{message}</div>
    {ctaLabel && ctaHref ? (
      <Button href={ctaHref} variant="ghost" size="sm">{ctaLabel}</Button>
    ) : null}
  </div>
</section>

<style>
  .banner {
    border: 1px solid var(--color-border);
    border-radius: var(--radius-3);
    padding: var(--space-3) var(--space-4);
    background: var(--color-surface-2);
  }

  .banner--info {
    background: var(--color-surface-2);
    border-color: var(--color-border);
  }

  .banner--warn {
    background: #fff4e3;
    border-color: #f97316;
  }

  .banner__inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-3);
    flex-wrap: wrap;
  }

  .banner__msg {
    font-weight: 700;
  }
</style>
</file>

<file path="web/src/components/ui/Button.astro">
---
type Variant = "primary" | "secondary" | "ghost";
type Size = "sm" | "md" | "lg";

type Props = {
  href?: string;
  external?: boolean;
  variant?: Variant;
  size?: Size;
  disabled?: boolean;
  autoFocus?: boolean;
};

const {
  href,
  external = false,
  variant = "primary",
  size = "md",
  disabled = false,
  autoFocus = false,
} = Astro.props as Props;

const className = `btn btn--${variant} btn--${size}`;
---

{href ? (
  <a
    class={className}
    href={href}
    target={external ? "_blank" : undefined}
    rel={external ? "noopener noreferrer" : undefined}
  >
    <slot />
  </a>
) : (
  <button class={className} type="button" disabled={disabled} autofocus={autoFocus}>
    <slot />
  </button>
)}

<style>
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    border-radius: var(--radius-2);
    text-decoration: none;
    font-weight: 700;
    border: 1px solid transparent;
    cursor: pointer;
    min-height: var(--target-min);
  }

  .btn--sm {
    font-size: var(--font-size-0);
    padding: var(--space-2) var(--space-3);
  }

  .btn--md {
    font-size: var(--font-size-1);
    padding: var(--space-2) var(--space-4);
  }

  .btn--lg {
    font-size: var(--font-size-2);
    padding: var(--space-3) var(--space-6);
  }

  .btn--primary {
    background: var(--color-primary);
    color: var(--color-white);
  }

  .btn--primary:hover {
    background: var(--color-primary-hover);
  }

  .btn--secondary {
    background: var(--color-gray-50);
    border-color: var(--color-border);
  }

  .btn--secondary:hover {
    background: var(--color-gray-100);
  }

  .btn--ghost {
    background: transparent;
    border-color: var(--color-border);
  }

  .btn--ghost:hover {
    background: var(--color-gray-50);
  }

  .btn:disabled {
    opacity: 0.65;
    cursor: not-allowed;
  }
</style>
</file>

<file path="web/src/components/ui/Card.astro">
---
type Props = {
  title: string;
  description?: string;
  href?: string;
};

const { title, description, href } = Astro.props;
---

{href ? (
  <a class="card card--link" href={href} aria-label={title}>
    <div class="card__title">{title}</div>
    {description && <p class="card__desc muted">{description}</p>}
    <span class="card__cta link" aria-hidden="true">Learn more</span>
  </a>
) : (
  <div class="card">
    <div class="card__title">{title}</div>
    {description && <p class="card__desc muted">{description}</p>}
  </div>
)}

<style>
  .card__title {
    font-weight: 800;
    font-size: var(--font-size-2);
    margin-bottom: var(--space-2);
  }

  .card__desc {
    margin: 0 0 var(--space-3);
  }

  .card__cta {
    font-weight: 700;
  }
</style>
</file>

<file path="web/src/content/events/sabbath-service.md">
---
title: "Sabbath Worship Service"
summary: "Join us each Sabbath for worship, prayer, and a message. Visitors are always welcome."
start: "2026-01-10T11:15:00-05:00"
end: "2026-01-10T12:45:00-05:00"
locationName: "First Springfield Seventh-day Adventist Church"
tags: ["worship", "sabbath"]
---

## What to expect

- A warm welcome
- Congregational singing
- Scripture and message

## Who can come?

Everyone. Come as you are.
</file>

<file path="web/src/content/ministries/children.md">
---
title: "Children’s Ministry"
summary: "Bible stories, songs, and activities designed for kids to grow in faith and community."
leaderName: "Children’s Ministry Team"
leaderEmail: "firstspringfieldsda@gmail.com"
meetingTime: "Sabbaths during the service"
category: "Children & Youth"
ctaLabel: "Contact us"
ctaHref: "/connect/contact"
tags: ["kids", "families"]
---

## Overview

We support families by providing age-appropriate activities and a safe environment.

## How to get involved

Talk to the greeter team or use the contact form.
</file>

<file path="web/src/data/site-links.json">
{
  "givingUrl": "https://adventistgiving.org/",
  "youtubeChannelUrl": "https://www.youtube.com/@1stspringfieldsdama74",
  "youtubeLiveEmbedUrl": "https://www.youtube.com/embed/live_stream?channel=UCkmryvqlHb3JIwVLc07FZwA",
  "facebookUrl": "TBD",
  "prayerFormUrl": "TBD",
  "contactFormUrl": "TBD",
  "volunteerFormUrl": "TBD",
  "oldWebsiteUrl": "https://firstspringfieldma.adventistchurch.org/"
}
</file>

<file path="web/src/pages/connect/about/index.astro">
---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { site } from "../../../data/site";

const { mission } = site;
---

<BaseLayout title="About Us" description={`About ${site.name} in Springfield, Massachusetts.`}>
  <div class="stack">
    <h1>About Us</h1>

    <section class="card stack--tight">
      <p class="muted">
        Our church is a vibrant, multicultural community located in the heart of Springfield, the
        third-largest city in the Commonwealth of Massachusetts. As of 2024, Springfield has an
        estimated population of approximately 154,888 residents, with around 25% living below the
        federal poverty line. Our church serves as a welcoming and safe haven for immigrants, refugees,
        and all who seek spiritual support and community.
      </p>
    </section>

    <section class="card stack--tight">
      <h2>Our Mission</h2>
      <p class="muted">
        {mission.statement}
      </p>
    </section>

    <section class="card stack--tight">
      <h2>Our Method</h2>
      <p class="muted">{mission.method}</p>
    </section>

    <section class="card stack--tight">
      <h2>Our Vision</h2>
      <p class="muted">
        {mission.vision}
      </p>
    </section>

    <section class="card stack--tight">
      <h2>Who We Are</h2>
      <p class="muted">
        We are a Christian faith community that is part of the worldwide Seventh-day Adventist Church.
        Rooted in the Bible and centered on Jesus Christ, we seek to reflect God’s love through worship,
        service, and community outreach.
      </p>

      <p class="muted">
        As Seventh-day Adventists, we value spiritual growth, healthy living, strong families, and
        compassionate service. We believe the church is not just a building, but a people called to live
        out their faith daily, serving God and our community with humility, integrity, and purpose.
      </p>

      <p class="muted">
        We welcome individuals and families from all backgrounds to join us as we grow in faith, study
        God’s Word, and prepare for the return of Jesus Christ.
      </p>
    </section>

    <section class="card stack--tight">
      <h2>What We Believe</h2>
      <p class="muted">
        Seventh-day Adventists accept the Bible as the inspired Word of God and base our beliefs on its
        teachings. Our core beliefs include:
      </p>

      <ul class="muted">
        <li>
          God – One God: Father, Son, and Holy Spirit, a loving Creator who desires a personal
          relationship with every person.
        </li>
        <li>
          Jesus Christ – Fully God and fully human, whose life, death, and resurrection provide
          salvation and hope for all.
        </li>
        <li>The Bible – God’s authoritative revelation of His will and truth.</li>
        <li>Salvation – A gift of grace received through faith in Jesus Christ, not by works.</li>
        <li>
          The Sabbath – The seventh day of the week, Saturday, observed as a sacred day of rest, worship,
          and fellowship.
        </li>
        <li>
          The Church – A community of believers called to worship God, support one another, and share
          the gospel.
        </li>
        <li>
          Health and Wholeness – A holistic approach to life that honors God by caring for the body,
          mind, and spirit.
        </li>
        <li>
          The Second Coming – The personal, visible return of Jesus Christ, which is the blessed hope of
          the church.
        </li>
      </ul>

      <p class="muted">
        We seek to live out these beliefs with love, compassion, and faithfulness as we serve God and
        others.
      </p>

      <p class="muted">
        Learn more about Adventist beliefs at{" "}
        <a href="https://www.adventist.org/beliefs/" target="_blank" rel="noopener noreferrer">
          adventist.org
        </a>
        .
      </p>
    </section>
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/connect/worship-with-us/index.astro">
---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import Schedule from "../../../components/ui/Schedule.astro";
import { site } from "../../../data/site";
---

<BaseLayout
  title="Worship With Us"
  description={`Learn what Sabbath School, Worship Service, and midweek Prayer Meeting are like at ${site.name}.`}
>
  <div class="stack">
    <h1>Worship With Us</h1>

    <Schedule title="Weekly Schedule" items={site.schedule} />

    <section class="card stack--tight">
      <h2>Sabbath School</h2>
      <p class="muted">
        Sabbath School is a Bible study time for all ages, with classes for children and adults.
      </p>
    </section>

    <section class="card stack--tight">
      <h2>Worship Service</h2>
      <p class="muted">
        Our worship service includes singing, prayer, Scripture, and a message from the Bible.
      </p>
    </section>

    <section class="card stack--tight">
      <h2>Midweek Prayer Meeting</h2>
      <p class="muted">
        Join us midweek for prayer, encouragement, and Bible study.
      </p>
    </section>
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/join/index.astro">
---
import BaseLayout from "../../layouts/BaseLayout.astro";
import CardGrid from "../../components/sections/CardGrid.astro";
import { site } from "../../data/site";
---

<BaseLayout title="Join" description={`Plan your first visit, learn what to expect, and get connected at ${site.name}.`}>
  <div class="stack">
    <h1>Join</h1>

    <CardGrid
      title="Start here"
      cards={[
        {
          title: "Plan a Visit",
          description: "Service times, directions, and what to expect.",
          href: "/connect/plan-a-visit"
        },
        {
          title: "Worship With Us",
          description: "Learn what our weekly services are like.",
          href: "/connect/worship-with-us"
        },
        {
          title: "Contact",
          description: "Phone, email, and how to reach us.",
          href: "/connect/contact"
        }
      ]}
    />
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/ministries/[id].astro">
---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection, getEntry } from "astro:content";
import { mailto } from "../../lib/links";

export async function getStaticPaths() {
  const ministries = await getCollection("ministries", ({ data }) =>
    import.meta.env.PROD ? data.draft !== true : true
  );
  return ministries.map((m) => ({ params: { id: m.id } }));
}

const { id } = Astro.params;

const ministry = await getEntry("ministries", id!);
if (!ministry) throw new Error(`Ministry not found: ${id}`);

const data: any = (ministry as any).data ?? {};
const isFilled = (value?: string) => Boolean(value && value.trim() && value !== "TBD");
const meetingTime = isFilled(data.meetingTime) ? data.meetingTime : "";
const leaderName = isFilled(data.leaderName) ? data.leaderName : "";
const leaderEmail = isFilled(data.leaderEmail)
  ? data.leaderEmail
  : isFilled(data.contactEmail)
    ? data.contactEmail
    : "";
const fallbackMessage = "Contact us for current meeting details.";

let Content: any = null;
// Only Markdown/MDX entries have entry.render()
if (typeof (ministry as any).render === "function") {
  const rendered = await (ministry as any).render();
  Content = rendered?.Content ?? null;
}

const title =
  data.title ??
  (typeof id === "string"
    ? id.replace(/[-_]/g, " ").replace(/\b\w/g, (c) => c.toUpperCase())
    : "Ministry");

const description =
  data.description ?? data.summary ?? `Learn more about ${title}.`;
---

<BaseLayout title={title} description={description}>
  <div class="stack">
    <h1>{title}</h1>

    <section class="card">
      <div class="stack--tight">
        <div class="stack--tight">
          <h2>When we meet</h2>
          {meetingTime ? (
            <p class="muted">{meetingTime}</p>
          ) : (
            <p class="muted">
              <a class="link" href="/connect/contact">{fallbackMessage}</a>
            </p>
          )}
        </div>
        <div class="stack--tight">
          <h2>Contact</h2>
          <div class="muted stack--tight">
            {leaderName ? <div>{leaderName}</div> : null}
            {leaderEmail ? (
              <a href={mailto(leaderEmail, `${title} ministry`)}>{leaderEmail}</a>
            ) : (
              <a class="link" href="/connect/contact">{fallbackMessage}</a>
            )}
          </div>
        </div>
      </div>
    </section>

    {Content ? (
      <section class="card">
        <div class="prose">
          <Content />
        </div>
      </section>
    ) : (
      <section class="card stack--tight">
        <p class="muted">{description}</p>
      </section>
    )}
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/ministries/index.astro">
---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Hero from '../../components/ui/Hero.astro';
import ContentCard from '../../components/content/ContentCard.astro';
import { getCollection } from 'astro:content';

const ministries = await getCollection('ministries', ({ data }) => {
  return import.meta.env.PROD ? data.draft !== true : true;
});

const sorted = ministries.sort((a, b) => a.data.title.localeCompare(b.data.title));
const grouped = sorted.reduce(
  (acc, ministry) => {
    const category = ministry.data.category ?? "Other";
    if (!acc[category]) acc[category] = [];
    acc[category].push(ministry);
    return acc;
  },
  {} as Record<string, typeof sorted>
);
const categoryOrder = [
  "Children & Youth",
  "Men",
  "Women",
  "Outreach",
  "Bible Study",
  "Leadership",
  "Other",
];
const orderedCategories = [
  ...categoryOrder.filter((category) => grouped[category]?.length),
  ...Object.keys(grouped)
    .filter((category) => !categoryOrder.includes(category))
    .sort((a, b) => a.localeCompare(b)),
];
---

<BaseLayout title="Ministries" description="Ways to serve and grow together.">
  <Hero title="Ministries" subtitle="Find a place to belong and serve." />

  <section class="stack">
    {sorted.length === 0 ? (
      <p class="muted">No ministries are published yet.</p>
    ) : (
      orderedCategories.map((category) => (
        <section class="stack--tight">
          <h2>{category}</h2>
          <div class="grid--cards">
            {grouped[category].map((m) => (
              <ContentCard
                href={`/ministries/${m.id}`}
                title={m.data.title}
                summary={m.data.summary}
                tags={m.data.tags}
              />
            ))}
          </div>
        </section>
      ))
    )}
  </section>
</BaseLayout>
</file>

<file path="web/src/pages/resources/bulletins/index.astro">
---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import Button from "../../../components/ui/Button.astro";
import Card from "../../../components/ui/Card.astro";
import CardGrid from "../../../components/ui/CardGrid.astro";
import { site } from "../../../data/site";
import { getCollection } from "astro:content";

const bulletins = await getCollection("bulletins", ({ data }) => {
  return import.meta.env.PROD ? data.draft !== true : true;
});

const sorted = bulletins.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
const current = sorted[0];
const archive = sorted.slice(1);

const fmt = new Intl.DateTimeFormat(site.locale, { dateStyle: "full", timeZone: site.timeZone });
---

<BaseLayout title="Bulletins" description="Weekly bulletins and archives.">
  <div class="stack">
    <h1>Bulletins</h1>
    <p class="muted">Weekly PDFs and an archive.</p>

    {sorted.length === 0 ? (
      <section class="card stack--tight">
        <p class="muted">No bulletins have been posted yet.</p>
      </section>
    ) : (
      <>
        <section class="card stack" aria-labelledby="bulletins-current">
          <h2 id="bulletins-current">Current bulletin</h2>
          <p class="muted">
            {current.data.title} • {fmt.format(current.data.date)}
          </p>
          {current.data.summary && (
            <p class="muted">{current.data.summary}</p>
          )}

          <div class="cluster">
            <Button href={current.data.pdfUrl} variant="secondary">Open PDF</Button>
          </div>
        </section>

        <section class="stack--tight" aria-labelledby="bulletins-archive">
          <h2 id="bulletins-archive">Archive</h2>

          {archive.length === 0 ? (
            <p class="muted">No archived bulletins yet.</p>
          ) : (
            <CardGrid columnsMin={260}>
              {archive.map((b) => (
                <Card
                  title={b.data.title}
                  description={fmt.format(b.data.date)}
                  href={b.data.pdfUrl}
                />
              ))}
            </CardGrid>
          )}
        </section>
      </>
    )}

    <p class="small muted">
      For church members: if you need a bulletin from a past week that isn’t listed, please contact the church.
    </p>
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/resources/forms/index.astro">
---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import Button from "../../../components/ui/Button.astro";
import CardGrid from "../../../components/ui/CardGrid.astro";
import Card from "../../../components/ui/Card.astro";
import { site } from "../../../data/site";

const phoneHref = `tel:${site.contact.phone.replace(/[^0-9+]/g, "")}`;

const hasPrayerForm = site.portals.prayerFormUrl && site.portals.prayerFormUrl !== "TBD";
const hasContactForm = site.portals.contactFormUrl && site.portals.contactFormUrl !== "TBD";
const hasVolunteerForm = site.portals.volunteerFormUrl && site.portals.volunteerFormUrl !== "TBD";
---

<BaseLayout title="Forms" description="Official request and signup forms.">
  <div class="stack">
    <h1>Forms</h1>
    <p class="muted">
      Official request and signup forms. If a form is not available, you can always contact the church.
    </p>

    <section class="card stack" aria-labelledby="forms-help">
      <h2 id="forms-help">Need help right now?</h2>
      <p class="muted">
        Call us at <a href={phoneHref}>{site.contact.phone}</a> or visit the <a href="/connect/contact">Contact</a> page.
      </p>
    </section>

    <section class="stack" aria-labelledby="forms-list">
      <h2 id="forms-list">Available forms</h2>

      <CardGrid columnsMin={260}>
        {hasPrayerForm && (
          <Card
            title="Prayer Request"
            description="Share a prayer request. Optionally ask for follow-up."
            href={site.portals.prayerFormUrl}
          />
        )}

        {hasContactForm && (
          <Card
            title="Contact / Questions"
            description="Send a message to the church."
            href={site.portals.contactFormUrl}
          />
        )}

        {hasVolunteerForm && (
          <Card
            title="Volunteer interest"
            description="Let us know how you’d like to serve."
            href={site.portals.volunteerFormUrl}
          />
        )}

        {(!hasPrayerForm || !hasContactForm || !hasVolunteerForm) && (
          <Card
            title="Other requests"
            description="If you don’t see a form you need, contact us and we’ll help."
            href="/connect/contact"
          />
        )}
      </CardGrid>

      <div class="cluster">
        {hasPrayerForm && (
          <Button href={site.portals.prayerFormUrl} external variant="secondary">Open prayer form</Button>
        )}
        {hasVolunteerForm && (
          <Button href={site.portals.volunteerFormUrl} external variant="secondary">Open volunteer form</Button>
        )}
      </div>

      <p class="small muted">
        Privacy note: only share information you’re comfortable sharing with a church prayer/team inbox.
      </p>
    </section>
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/search/index.astro">
---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Hero from "../../components/ui/Hero.astro";
import Search from "astro-pagefind/components/Search";
---

<BaseLayout
  title="Search"
  description="Search pages, resources, and bulletins."
  noIndex={true}
>
  <div class="stack">
    <Hero title="Search" subtitle="Search resources, bulletins, and site pages." />

    <section aria-label="Site search" class="card stack">
      <label id="site-search-label" for="site-search-input" class="form-label">
        Search the site
      </label>

      <div>
        {/* astro-pagefind expects an id so it can mount Pagefind UI into this element */}
        <Search
          id="site-search"
          className="pagefind-ui"
          uiOptions={{
            showImages: false,
            showSubResults: true,
            excerptLength: 20,
            resetStyles: false,
            placeholder: "Search the site…",
          }}
        />
      </div>

      <script is:inline>
        {String.raw`(() => {
          const ROOT_ID = "site-search";
          const LABEL_ID = "site-search-label";
          const INPUT_ID = "site-search-input";

          const root = document.getElementById(ROOT_ID);
          if (!root) return;

          const ensureLabel = () => {
            const input = root.querySelector("input.pagefind-ui__search-input");
            if (!input) return false;

            // Tie visible <label> to the generated input
            input.id = INPUT_ID;
            input.setAttribute("aria-labelledby", LABEL_ID);

            // Also give it a direct accessible name (so it's never title-only)
            input.setAttribute("aria-label", "Search the site");

            // Title can exist, but we remove it to avoid "title-only" naming paths
            input.removeAttribute("title");

            return true;
          };

          // Try immediately
          if (ensureLabel()) return;

          // Keep watching until Pagefind mounts (no tiny timeout)
          const obs = new MutationObserver(() => {
            if (ensureLabel()) obs.disconnect();
          });

          obs.observe(root, { childList: true, subtree: true });

          // Safety valve: stop watching after 60s (prevents runaway observers)
          setTimeout(() => obs.disconnect(), 60_000);
        })();`}
      </script>


      <details class="small muted stack--tight">
        <summary>How search works</summary>
        <p>
          Search runs in your browser using a static index generated at build time.
          Your search terms are not sent to the site server.
        </p>
      </details>
    </section>
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/serve/index.astro">
---
import BaseLayout from "../../layouts/BaseLayout.astro";
import CardGrid from "../../components/sections/CardGrid.astro";
import { site } from "../../data/site";
---

<BaseLayout title="Serve" description={`Find a place to belong, serve, and grow with ${site.name}.`}>
  <div class="stack">
    <h1>Serve</h1>

    <CardGrid
      title="Get involved"
      cards={[
        {
          title: "Volunteer",
          description: "Find a place to serve based on your interests.",
          href: "/resources/forms"
        },
        {
          title: "Prayer Request",
          description: "Join our prayer ministry or submit a request.",
          href: "/connect/prayer"
        },
        {
          title: "Contact",
          description: "Reach out and we’ll help you get connected.",
          href: "/connect/contact"
        }
      ]}
    />
  </div>
</BaseLayout>
</file>

<file path="web/src/styles/global.css">
@import "./tokens.css";

:root {
  color-scheme: light;
}

* {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  padding: 0;
}

body {
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  font-size: var(--font-size-1);
  line-height: 1.6;
  color: var(--color-text);
  background: var(--color-bg);
}

h1 {
  font-size: clamp(2.2rem, 1.6rem + 2.4vw, 3.2rem);
  line-height: 1.1;
  letter-spacing: -0.02em;
}

h2 {
  font-size: clamp(1.6rem, 1.2rem + 1.6vw, 2.4rem);
  line-height: 1.2;
  letter-spacing: -0.01em;
}

h3 {
  font-size: clamp(1.25rem, 1.05rem + 1vw, 1.7rem);
  line-height: 1.25;
}

p,
li {
  max-width: 70ch;
}

a {
  color: inherit;
}

summary {
  min-height: var(--target-min);
  padding-block: var(--space-2);
}

.link {
  color: var(--color-primary);
  text-decoration-line: underline;
  text-decoration-thickness: 0.08em;
  text-underline-offset: 0.2em;
  text-decoration-skip-ink: auto;
  font-weight: 600;
  transition: color 120ms ease, text-decoration-thickness 120ms ease;
}

.link:hover {
  color: var(--color-primary-hover);
  text-decoration-thickness: 0.14em;
}

a:focus-visible,
button:focus-visible,
summary:focus-visible {
  outline: 3px solid var(--color-focus);
  outline-offset: 3px;
}

.container {
  width: min(var(--container-max), calc(100% - var(--container-pad)));
  margin: 0 auto;
}

.fullbleed {
  width: 100vw;
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
}

.main {
  padding: var(--space-8) 0;
}

.small {
  font-size: var(--font-size-0);
}

.muted {
  color: var(--color-text-muted);
}

.form-label {
  font-weight: 700;
}

.card {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-4);
  padding: var(--space-6);
  box-shadow: var(--shadow-1);
  transition: transform 160ms ease, box-shadow 160ms ease, border-color 160ms ease;
}

.card--link {
  display: block;
  color: inherit;
  text-decoration: none;
}

.card--link:hover,
.card--link:focus-visible {
  transform: translateY(-3px);
  box-shadow: var(--shadow-2);
  border-color: var(--color-border-strong);
}

.prose > * {
  margin: 0;
}

.prose > * + * {
  margin-top: var(--space-4);
}

.prose :where(h2, h3, h4) {
  margin-top: var(--space-6);
  margin-bottom: var(--space-2);
}

.prose :where(ul, ol) {
  padding-left: 1.4rem;
}

.prose :where(li + li) {
  margin-top: var(--space-2);
}

.prose :where(blockquote) {
  margin-left: 0;
  padding-left: var(--space-4);
  border-left: 3px solid var(--color-border);
  color: var(--color-text-muted);
}

.stack,
.stack--tight,
.stack--loose {
  display: grid;
}

.stack {
  gap: var(--space-6);
}

.stack--tight {
  gap: var(--space-2);
}

.stack--loose {
  gap: var(--space-8);
}

.stack > *,
.stack--tight > *,
.stack--loose > * {
  margin: 0;
}

.cluster {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: var(--space-3);
}

.cluster--between {
  justify-content: space-between;
}

.cluster--baseline {
  align-items: baseline;
}

.cluster--loose {
  gap: var(--space-4);
}

.grid {
  display: grid;
  gap: var(--space-4);
}

.grid--cards {
  display: grid;
  gap: var(--space-4);
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.skip-link {
  position: absolute;
  top: var(--space-2);
  left: var(--space-2);
  padding: var(--space-2) var(--space-3);
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-2);
  text-decoration: none;
  transform: translateY(-200%);
  transition: transform 120ms ease;
  z-index: 999;
}

.skip-link:focus {
  transform: translateY(0);
}

@media (max-width: 860px) {
  .main {
    padding: var(--space-6) 0;
  }
}
</file>

<file path="web/src/styles/tokens.css">
:root {
  /* Primitive tokens */
  --color-white: #ffffff;
  --color-black: #0b0f17;
  --color-gray-50: #f7f8fa;
  --color-gray-100: #eef0f4;
  --color-gray-200: #dfe3ea;
  --color-gray-500: #6b7280;
  --color-gray-600: #4b5563;
  --color-blue-600: #1d4ed8;
  --color-blue-700: #1e40af;

  --space-1: 0.25rem;
  --space-2: 0.5rem;
  --space-3: 0.75rem;
  --space-4: 1rem;
  --space-6: 1.5rem;
  --space-8: 2rem;
  --space-12: 3rem;

  --radius-2: 0.5rem;
  --radius-3: 0.75rem;
  --radius-4: 1rem;

  --font-size-0: 0.95rem;
  --font-size-1: 1rem;
  --font-size-2: 1.125rem;
  --font-size-3: 1.35rem;
  --font-size-4: 1.8rem;
  --font-size-5: 2.25rem;

  --shadow-1: 0 1px 2px rgba(0, 0, 0, 0.06);
  --shadow-2: 0 12px 28px rgba(0, 0, 0, 0.12);

  /* Semantic tokens */
  --color-bg: var(--color-white);
  --color-surface: var(--color-white);
  --color-surface-2: var(--color-gray-50);
  --color-surface-muted: var(--color-surface-2);
  --color-text: var(--color-black);
  --color-text-muted: var(--color-gray-600);
  --color-border: rgba(17, 25, 30, 0.16);
  --color-border-strong: rgba(17, 25, 30, 0.26);
  --color-primary: #6c1d25;
  --color-primary-hover: #7f2a32;
  --color-focus: #2d6cdf;

  --container-max: 1100px;
  --container-pad: var(--space-8);
  --target-min: 44px;
}

@media (max-width: 720px) {
  :root {
    --container-pad: var(--space-6);
  }
}
</file>

<file path="web/src/content.config.ts">
import { glob } from "astro/loaders";
import { z } from "astro/zod";
import { defineCollection } from "astro:content";

const shared = z.object({
  title: z.string(),
  summary: z.string(),
  tags: z.array(z.string()).optional(),
  draft: z.boolean().optional(),
  heroImage: z.string().optional(),
});

const events = defineCollection({
  loader: glob({ pattern: "**/[^_]*.md", base: "./src/content/events" }),
  schema: shared.extend({
    start: z.coerce.date(),
    end: z.coerce.date().optional(),
    locationName: z.string().optional(),
    address: z.string().optional(),
    registrationUrl: z.string().optional(), // allow relative or absolute
  }),
});

const ministries = defineCollection({
  loader: glob({ pattern: "**/[^_]*.md", base: "./src/content/ministries" }),
  schema: shared.extend({
    leaderName: z.string().optional(),
    leaderEmail: z.string().optional(),
    meetingTime: z.string().optional(),
    contactEmail: z.string().optional(),
    contactPhone: z.string().optional(),
    category: z.string().optional(),
    ctaLabel: z.string().optional(),
    ctaHref: z.string().optional(),
  }),
});

const resources = defineCollection({
  loader: glob({ pattern: "**/[^_]*.md", base: "./src/content/resources" }),
  schema: shared.extend({
    published: z.coerce.date(),
    category: z.string().optional(),
    attachmentUrl: z.string().optional(), // allow relative or absolute
    externalUrl: z.string().optional(),
  }),
});

const bulletins = defineCollection({
  loader: glob({ pattern: "**/[^_]*.md", base: "./src/content/bulletins" }),
  schema: z.object({
    title: z.string(),
    summary: z.string().optional(),
    date: z.coerce.date(),
    pdfUrl: z.string(), // your content uses /bulletins/... :contentReference[oaicite:4]{index=4}
    draft: z.boolean().optional(),
  }),
});

export const collections = { events, ministries, resources, bulletins };
</file>

<file path="web/tests/e2e/phase-7-a11y.spec.ts">
import AxeBuilder from "@axe-core/playwright";
import { expect, test } from "@playwright/test";

const PAGES = [
  "/",
  "/components",
  "/connect/plan-a-visit",
  "/connect/team",
  "/events",
  "/resources",
  "/media",
  "/search",
];

for (const path of PAGES) {
  test(`a11y (axe) - ${path}`, async ({ page }) => {
    await page.goto(path);

    if (path === "/search") {
      await page.locator("#site-search input.pagefind-ui__search-input").waitFor();

      // Ensure the Pagefind input has a real label (axe: label-title-only)
      await page.evaluate(() => {
        const root = document.getElementById("site-search");
        const input = root?.querySelector("input.pagefind-ui__search-input") as HTMLInputElement | null;
        const label = document.getElementById("site-search-label") as HTMLLabelElement | null;

        if (!input || !label) return;

        input.id = "site-search-input";
        input.setAttribute("aria-labelledby", "site-search-label");
        input.setAttribute("aria-label", "Search the site");
        input.removeAttribute("title");
      });
    }

    const results = await new AxeBuilder({ page }).analyze();

    const highImpact = results.violations.filter((v) =>
      ["serious", "critical"].includes(v.impact ?? "")
    );

    expect(highImpact).toEqual([]);
  });
}
</file>

<file path=".repomixignore">
*.d.ts
*.svg
web/.lighthouseci
web/.wrangler
package/
</file>

<file path="web/src/components/Header.astro">
---
import { site } from "../data/site";

const pathname = Astro.url.pathname;

function isActive(href: string) {
  if (href === "/") return pathname === "/";
  return pathname === href || pathname.startsWith(href + "/");
}

function linkAttrs(item: { href: string; external?: boolean }) {
  return item.external
    ? { target: "_blank", rel: "noopener noreferrer" }
    : {};
}
---

<header class="header">
  <div class="container header__inner">
    <div class="header__brand">
      <a href="/">{site.shortName}</a>
      <div class="small muted">Site under construction (MVP)</div>
    </div>

    <div class="header__desktop" aria-label="Header navigation">
      <nav class="nav" aria-label="Primary navigation">
        {site.nav.map((item) => (
          <a
            href={item.href}
            aria-current={isActive(item.href) ? "page" : undefined}
            {...linkAttrs(item)}
          >
            {item.label}
          </a>
        ))}
      </nav>

      <nav class="nav" aria-label="Quick actions">
        {site.quickActions.map((item) => (
          <a
            href={item.href}
            style="font-weight: 700;"
            aria-current={isActive(item.href) ? "page" : undefined}
            {...linkAttrs(item)}
          >
            {item.label}
          </a>
        ))}
      </nav>
    </div>

    <div class="header__mobile">
      <details class="menu">
        <summary aria-label="Open menu">Menu</summary>
        <div class="menu__panel" aria-label="Mobile menu">
          <div>
            <div class="menu__sectionTitle">Navigate</div>
            <nav class="nav" aria-label="Primary navigation (mobile)">
              {site.nav.map((item) => (
                <a
                  href={item.href}
                  aria-current={isActive(item.href) ? "page" : undefined}
                  {...linkAttrs(item)}
                >
                  {item.label}
                </a>
              ))}
            </nav>
          </div>

          <div>
            <div class="menu__sectionTitle">Quick actions</div>
            <nav class="nav" aria-label="Quick actions (mobile)">
              {site.quickActions.map((item) => (
                <a
                  href={item.href}
                  style="font-weight: 700;"
                  aria-current={isActive(item.href) ? "page" : undefined}
                  {...linkAttrs(item)}
                >
                  {item.label}
                </a>
              ))}
            </nav>
          </div>
        </div>
      </details>
    </div>
  </div>
</header>

<script>
  // Close the mobile menu when a link is clicked.
  document.addEventListener("click", (e) => {
    const target = e.target;
    if (!(target instanceof HTMLElement)) return;

    const link = target.closest("a");
    const details = target.closest("details.menu");
    if (link && details) details.removeAttribute("open");
  });
</script>
</file>

<file path="web/src/pages/connect/plan-a-visit/index.astro">
---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import Schedule from "../../../components/ui/Schedule.astro";
import { site } from "../../../data/site";
---

<BaseLayout
  title="Plan a Visit"
  description={`Service times, directions, parking, and what to expect when visiting ${site.name}.`}
>
  <div class="stack">
    <h1>Plan a Visit</h1>

    <Schedule title="Service Times" items={site.schedule} />

    <section class="card stack">
      <h2>Directions</h2>
      <p class="muted">
        Address:{" "}
        <a href={site.contact.mapsUrl} target="_blank" rel="noopener noreferrer">
          {site.contact.address}
        </a>
      </p>

      <ul class="muted">
        {site.visit.directions.map((d) => (
          <li>{d}</li>
        ))}
      </ul>
    </section>

    <section class="card stack">
      <h2>What to expect</h2>
      <p class="muted">{site.visit.languageNote}</p>
      <p class="muted">{site.visit.parkingNote}</p>
      <p class="muted">{site.visit.accessibilityNote}</p>
    </section>
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/connect/prayer/index.astro">
---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import Button from "../../../components/ui/Button.astro";
import { site } from "../../../data/site";

const prayerFormUrl = site.portals?.prayerFormUrl;
const hasPrayerForm = Boolean(prayerFormUrl && prayerFormUrl !== "TBD");
---

<BaseLayout title="Prayer Request" description={`Submit a prayer request to ${site.name}.`}>
  <div class="stack">
    <h1>Prayer Request</h1>

    <section class="card stack">
      <h2>How can we pray for you?</h2>
      <p class="muted">
        We believe prayer matters. Share a request and our prayer team will pray with you.
      </p>

      <div class="cluster">
        {hasPrayerForm ? (
          <Button href={prayerFormUrl} external variant="secondary">Submit Prayer Request</Button>
        ) : (
          <Button href={`mailto:${site.contact.email}?subject=Prayer%20Request`} variant="secondary">
            Email a Prayer Request
          </Button>
        )}
        <Button href="/connect/contact" variant="ghost">Contact</Button>
      </div>

      <p class="small muted">
        Please avoid including sensitive information.
      </p>
    </section>
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/connect/index.astro">
---
import BaseLayout from "../../layouts/BaseLayout.astro";
import CardGrid from "../../components/sections/CardGrid.astro";
import { site } from "../../data/site";
---

<BaseLayout
  title="Connect"
  description={`Plan a visit, learn about worship, request prayer, and get in touch with ${site.name}.`}
>
  <div class="stack">
    <h1>Connect</h1>

    <CardGrid
      title="Ways to connect"
      cards={[
        {
          title: "Plan a Visit",
          description: "Service times, directions, and what to expect.",
          href: "/connect/plan-a-visit"
        },
        {
          title: "Worship With Us",
          description: "Learn about Sabbath School and worship service.",
          href: "/connect/worship-with-us"
        },
        {
          title: "Prayer Request",
          description: "Share a prayer request with our prayer team.",
          href: "/connect/prayer"
        },
        {
          title: "Contact",
          description: "Phone, email, and how to reach us.",
          href: "/connect/contact"
        }
      ]}
    />
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/give/index.astro">
---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Button from "../../components/ui/Button.astro";
import { site } from "../../data/site";
---

<BaseLayout title="Give" description={`Support ${site.name} through online giving.`}>
  <div class="stack">
    <h1>Give</h1>

    <section class="card stack">
      <h2>Thank you for your generosity</h2>
      <p class="muted">
        Your giving supports ministry, outreach, and the mission of our church.
      </p>

      <div class="cluster">
        <Button href={site.portals.givingUrl} external variant="secondary">Give Online</Button>
        <Button href="/connect/contact" variant="ghost">Questions?</Button>
      </div>

      <p class="small muted">
        If you prefer to give in person, you can also give during worship service.
      </p>
    </section>
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/media/live/index.astro">
---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import YouTubeEmbed from "../../../components/ui/YouTubeEmbed.astro";
import Button from "../../../components/ui/Button.astro";
import { site } from "../../../data/site";

const hasEmbed = site.portals.youtubeLiveEmbedUrl && site.portals.youtubeLiveEmbedUrl !== "TBD";
const hasYouTube = site.portals.youtubeChannelUrl && site.portals.youtubeChannelUrl !== "TBD";
---

<BaseLayout title="Watch Live" description={`Watch ${site.shortName} live.`}>
  <div class="stack">
    <h1>Watch Live</h1>

    {hasEmbed ? (
      <YouTubeEmbed
        title={`${site.shortName} Live`}
        embedUrl={site.portals.youtubeLiveEmbedUrl}
      />
    ) : (
      <section class="card stack--tight">
        <h2>Live stream coming soon</h2>
        <p class="muted">
          We’re preparing a live stream. Check back soon or join us in person.
        </p>
        <div class="cluster">
          <Button href="/connect/plan-a-visit" variant="secondary">Plan a Visit</Button>
          <Button href="/media/videos" variant="ghost">Watch Videos</Button>
        </div>
      </section>
    )}

    {hasYouTube ? (
      <Button href={site.portals.youtubeChannelUrl} external variant="secondary">
        Open YouTube channel
      </Button>
    ) : (
      <p class="small muted">
        YouTube channel coming soon.
      </p>
    )}
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/media/videos/index.astro">
---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import Button from "../../../components/ui/Button.astro";
import { site } from "../../../data/site";

const hasYouTube = site.portals.youtubeChannelUrl && site.portals.youtubeChannelUrl !== "TBD";
---

<BaseLayout title="Videos" description={`Recent videos from ${site.name}.`}>
  <div class="stack">
    <h1>Videos</h1>

    <section class="card stack">
      <h2>Watch on YouTube</h2>
      <p class="muted">
        Browse recent messages and live streams on our YouTube channel.
      </p>

      {hasYouTube ? (
        <Button href={site.portals.youtubeChannelUrl} external variant="secondary">
          Browse on YouTube
        </Button>
      ) : (
        <p class="small muted">
          Our YouTube channel is coming soon. Check back or{" "}
          <a class="link" href="/connect/contact">contact us</a> for the latest links.
        </p>
      )}
    </section>
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/media/index.astro">
---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Card from "../../components/ui/Card.astro";
import Grid from "../../components/ui/CardGrid.astro";
import { site } from "../../data/site";
---

<BaseLayout title="Media" description={`Watch live and browse recent videos from ${site.name}.`}>
  <div class="stack">
    <h1>Media</h1>

    <section aria-label="Quick links" class="stack--tight">
      <h2>Quick links</h2>

      <Grid columnsMin={240}>
        <Card
          title="Watch Live"
          description="Join our live stream when available."
          href="/media/live"
        />
        <Card
          title="Videos"
          description="Browse recent sermons and messages."
          href="/media/videos"
        />
      </Grid>
    </section>
  </div>
</BaseLayout>
</file>

<file path="web/src/pages/resources/index.astro">
---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Hero from '../../components/ui/Hero.astro';
import ContentCard from '../../components/content/ContentCard.astro';
import { getCollection } from 'astro:content';
import { site } from '../../data/site';

const resources = await getCollection('resources', ({ data }) => {
  return import.meta.env.PROD ? data.draft !== true : true;
});

const latest = resources
  .sort((a, b) => b.data.published.valueOf() - a.data.published.valueOf())
  .slice(0, 15);

const fmt = new Intl.DateTimeFormat(site.locale, {
  dateStyle: 'medium',
  timeZone: site.timeZone
});
---

<BaseLayout title="Resources" description="Helpful links, forms, bulletins, and downloads.">
  <Hero title="Resources" subtitle="Downloads, forms, and helpful info." />

  <section class="stack--loose">
    <div class="grid--cards">
      <article class="card stack--tight">
        <h3>
          <a class="link" href="/search">Search</a>
        </h3>
        <p class="muted">Find resources, bulletins, and more.</p>
      </article>
      <article class="card stack--tight">
        <h3><a class="link" href="/resources/bulletins">Bulletins</a></h3>
        <p class="muted">Weekly PDFs and archives.</p>
      </article>
      <article class="card stack--tight">
        <h3><a class="link" href="/resources/forms">Forms</a></h3>
        <p class="muted">Requests, sign-ups, and contact info.</p>
      </article>
    </div>

    <div class="stack">
      <h2>Latest resources</h2>

      {latest.length === 0 ? (
        <p class="muted">No resources are published yet.</p>
      ) : (
        <div class="grid--cards">
          {latest.map((r) => (
            <ContentCard
              href={`/resources/${r.id}`}
              title={r.data.title}
              summary={r.data.summary}
              meta={fmt.format(r.data.published)}
              tags={r.data.tags}
            />
          ))}
        </div>
      )}
    </div>
  </section>
</BaseLayout>
</file>

<file path="web/astro.config.mjs">
import cloudflare from "@astrojs/cloudflare";
import mdx from "@astrojs/mdx";
import sitemap from "@astrojs/sitemap";
import compress from "astro-compress";
import icon from "astro-icon";
import pagefind from "astro-pagefind";
import { defineConfig } from "astro/config";

const site = process.env.PUBLIC_SITE_URL;

export default defineConfig({
  // Used for canonical URLs + sitemap/robots generation.
  // In Cloudflare Pages: set PUBLIC_SITE_URL to your production domain (e.g. https://example.org)
  site: site ?? "http://localhost:4321",
  trailingSlash: "never",

  integrations: [
    mdx(),
    icon(),
    compress(),
    pagefind(),
    sitemap({
      // Internal site search is not a page you want indexed.
      filter: (page) => !page.endsWith("/search"),
    }),
  ],

  output: "static",
  adapter: cloudflare(),
  vite: {
    ssr: {
      noExternal: ["@fontsource-variable/inter"],
    },
  },
});
</file>

<file path="README.md">
# First Springfield Church Website

![CI](https://github.com/josuejero/church-website/actions/workflows/web/.github/workflows/ci.yml/badge.svg) ![Lighthouse CI budget enforced](https://img.shields.io/badge/Lighthouse%20CI-budget%20enforced-brightgreen)

This repo hosts the new First Springfield SDA site built with Astro and Cloudflare Workers. The focus is on a fast, accessible experience for worshipers, visitors, and church staff who need schedules, ministries, giving links, and helpful content in a heartbeat.

**Live demo:** https://firstspringfieldma.adventistchurch.org/

## Why this project is a UI-intern-quality repo

- **UI from spec:** the designer handoff lives in [docs/ui-handoff.md](docs/ui-handoff.md), showing how colors, spacing, and layout principles translate into code.
- **Cross-browser smoke:** Playwright runs the Chromium full suite plus Firefox/WebKit smoke tests to prove it works everywhere.
- **Accessibility:** axe scans are part of the CI workflow so every push guards against regressions.
- **Performance:** Lighthouse CI budgets are enforced to keep the experience fast.
- **Cross-device:** Playwright `mobile-smoke` project plus device emulation validate the UI at representative mobile viewports.

## Getting started

1. `cd web`
2. `npm install`
3. `npm run dev`

The remaining scripts live inside `web/package.json`. `npm run build` produces a static output in `web/dist`, and `npm run preview` lets you inspect the production bundle locally before deployment.

## Local development

| Command | Purpose |
| --- | --- |
| `cd web && npm install` | Install dependencies and make the Astro scripts available. |
| `cd web && npm run dev` | Start the Astro dev server at `localhost:4321`. |
| `cd web && npm run qa` | Run `astro check`, Playwright E2E, Linkinator, and Lighthouse locally. |
| `cd web && npm run format` | Format Astro/Svelte files with Prettier + plugins. |

## Tech highlights

- Astro + Cloudflare Workers deliver content-first rendering with partial hydration where it makes the most sense.
- Tokens govern spacing, typography, color, and elevation so the component library stays cohesive.
- Accessibility-first surface rules (focus-visible, skip link, 44px tap targets, semantic headings) keep the site welcoming to everyone.
- Accessibility commitment: We follow WCAG 2.2 intent—44px tap targets, strong focus indicators, meaningful heading hierarchy, and keyboard navigation via the skip link so the UI feels reliable on every device (`web/src/styles/a11y.css`, `web/tests/e2e/phase-7-a11y.spec.ts`).
- A smoke suite (Playwright E2E, Linkinator links, Lighthouse CI) keeps regressions off the branch.
- Performance, accessibility, best practices, and SEO budgets run inside CI so builds never slip below the target thresholds.

## Engineering highlights

- Design tokens and the shared component library keep layout rhythm consistent as new stories land.
- The cross-engine smoke suite stitches together Playwright, link checking, and Lighthouse to prove the experience in multiple browsers.
- CI enforces the lightweight Lighthouse budget plus Playwright/linkinator updates on every push.

## Performance budget (Lighthouse CI)

![Latest Lighthouse CI run](docs/assets/lighthouse-latest.png)

We enforce a small Lighthouse CI budget in order to catch “death by a thousand cuts” (unoptimized images, heavy scripts, accidental layout shifts) before it reaches production:
- The CI workflow now runs `treosh/lighthouse-ci-action`, uploads `web/.lighthouseci` as the `lighthouseci` artifact, and posts a PR comment (`tag: lighthouse-ci`) that links to the temporary HTML report so reviewers see the latest scores without rerunning locally.
- Performance score must stay at or above 0.90.
- Accessibility score must stay at or above 0.95.
- Best Practices score must stay at or above 0.95.
- SEO score must stay at or above 0.95.

Lighthouse category assertions operate on a 0–1 scale in CI configs, so 0.90 corresponds to “90/100 style” expectations. Config: `web/lighthouserc.cjs`. Run locally from the `web/` folder via `npm run lighthouse`.

## Supporting docs

- [Design handoff](docs/ui-handoff.md)
- [Web developer README](web/README.md)
- [Component guide (living style guide)](/components)
- [Community health docs](CONTRIBUTING.md) _(includes CONTRIBUTING, CODE_OF_CONDUCT, SECURITY, LICENSE)_

## Troubleshooting

- If Playwright fails locally, run `npx playwright install --with-deps` and consult Playwright’s docs on CI workflows/setup patterns.
- If Lighthouse CI fails, inspect large images or heavyweight scripts, optimize them, and rerun `npm run lighthouse`; budgets guard performance, accessibility, best practices, and SEO.
</file>

<file path="web/src/components/Footer.astro">
---
import { site } from "../data/site";

const year = new Date().getFullYear();
---

<footer class="footer">
  <div class="container footer__inner">
    <div class="footer__cols">
      <div>
        <div class="footer__title">{site.name}</div>
        <p class="muted" style="margin: 0;">
          <a href={site.contact.mapsUrl} target="_blank" rel="noopener noreferrer">
            {site.contact.address}
          </a>
        </p>
      </div>

      <div>
        <div class="footer__title">Contact</div>
        <ul class="footer__list">
          <li><a href={`tel:${site.contact.phone.replace(/[^0-9+]/g, "")}`}>{site.contact.phone}</a></li>
          <li><a href={`mailto:${site.contact.email}`}>{site.contact.email}</a></li>
          <li><a href="/connect/contact">Contact page</a></li>
        </ul>
      </div>

      <div>
        <div class="footer__title">Service times</div>
        <ul class="footer__list">
          {site.schedule.map((item) => (
            <li><strong>{item.label}:</strong> {item.day} - {item.time}</li>
          ))}
        </ul>
      </div>

      <div>
        <div class="footer__title">Links</div>
        <div class="nav" aria-label="Footer links">
          <a href="/give">Give</a>
          <a href="/media/live">Watch Live</a>
          <a href="/resources/bulletins">Bulletins</a>
          <a href="/resources/forms">Forms</a>
        </div>
        <div class="nav" aria-label="Social links" style="margin-top: var(--space-2);">
          {site.social.map((item) => (
            <a href={item.href} target="_blank" rel="noopener noreferrer">{item.label}</a>
          ))}
        </div>
      </div>
    </div>

    <div class="small muted">© {year} {site.name}</div>
  </div>
</footer>
</file>

<file path="web/src/layouts/BaseLayout.astro">
---
import "../styles/global.css";
import "../styles/a11y.css";

import Header from "../components/global/Header.astro";
import Footer from "../components/global/Footer.astro";
import { site } from "../data/site";

export type Props = {
  title?: string;
  description?: string;
  noIndex?: boolean;
  ogImagePath?: string; // e.g. "/og/default.png"
  ogType?: "website" | "article";
};

const {
  title,
  description,
  noIndex = false,
  ogImagePath = "/og/default.png",
  ogType = "website",
} = Astro.props;

const pageTitle = title ? `${title} · ${site.shortName}` : site.name;
const pageDescription = description ?? site.description;

const baseUrl = Astro.site ?? new URL(Astro.url.origin);
const canonicalUrl = new URL(Astro.url.pathname, baseUrl).href;
const ogImageUrl = new URL(ogImagePath, baseUrl).href;
const locale = site.locale ?? "en-US";
const ogLocale = locale.replace("-", "_");
---

<!doctype html>
<html lang={locale.split("-")[0]}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>{pageTitle}</title>
    <meta name="description" content={pageDescription} />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="sitemap" href="/sitemap-index.xml" />

    <link rel="canonical" href={canonicalUrl} />
    <meta name="robots" content={noIndex ? "noindex,follow" : "index,follow"} />

    <meta property="og:site_name" content={site.name} />
    <meta property="og:title" content={pageTitle} />
    <meta property="og:description" content={pageDescription} />
    <meta property="og:type" content={ogType} />
    <meta property="og:locale" content={ogLocale} />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:image" content={ogImageUrl} />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={pageTitle} />
    <meta name="twitter:description" content={pageDescription} />
    <meta name="twitter:image" content={ogImageUrl} />

    <slot name="head" />
  </head>
  <body>
    <a class="skip-link" href="#main">Skip to content</a>
    <Header />
    <main id="main" class="main">
      <div class="container">
        <slot />
      </div>
    </main>
    <Footer />
  </body>
</html>
</file>

<file path="web/src/pages/connect/contact/index.astro">
---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import Button from "../../../components/ui/Button.astro";
import Schedule from "../../../components/ui/Schedule.astro";
import MapEmbed from "../../../components/ui/MapEmbed.astro";
import { site } from "../../../data/site";
import { tel } from "../../../lib/links";

const phoneHref = tel(site.contact.phone);
const pastorCellHref = tel(site.contact.pastorCell);
const pastorCellLabel = site.contact.pastorCellLabel ?? "Pastor Kobe (call/text)";
const hasPastorCell = Boolean(site.contact.pastorCell && site.contact.pastorCell.trim());
const hasContactForm = site.portals.contactFormUrl && site.portals.contactFormUrl !== "TBD";
const hasFacebook = site.portals.facebookUrl && site.portals.facebookUrl !== "TBD";
const hasYouTube = site.portals.youtubeChannelUrl && site.portals.youtubeChannelUrl !== "TBD";
const hasMailing = Boolean(site.contact.mailingAddress && site.contact.mailingAddress.trim().length);
---

<BaseLayout
  title="Contact"
  description={`Contact ${site.name}: address, service times, phone, and email.`}
>
  <div class="stack">
    <h1>Contact</h1>

    <section class="card stack" aria-labelledby="contact-address">
      <h2 id="contact-address">Address</h2>
      <p class="muted">
        <a href={site.contact.mapsUrl} target="_blank" rel="noopener noreferrer">{site.contact.address}</a>
      </p>

      {hasMailing ? (
        <p class="small muted">
          Mail: {site.contact.mailingAddress}
        </p>
      ) : null}

      <div class="cluster">
        <Button href={site.contact.mapsUrl} external variant="secondary">Open in Maps</Button>
        <Button href="/connect/plan-a-visit" variant="ghost">Plan a Visit</Button>
      </div>
      </section>

      <section class="card stack" aria-labelledby="contact-map">
        <h2 id="contact-map">Map</h2>
        <p class="muted">
          Prefer Google Maps? <a href={site.contact.mapsUrl} target="_blank" rel="noopener noreferrer">Open directions</a>.
        </p>
        <MapEmbed src={site.map.embedSrc} title={`${site.name} location map`} />
      </section>

    <Schedule title="Service Times" items={site.schedule} />

    {hasPastorCell ? (
      <section class="card stack" aria-labelledby="contact-pastor">
        <h2 id="contact-pastor">{pastorCellLabel}</h2>
        <p class="muted">
          The church phone may not be answered 24/7. For a faster response, call or text Pastor Kobe:
          <a href={pastorCellHref}>{site.contact.pastorCell}</a>
        </p>
      </section>
    ) : null}

    <section class="card stack" aria-labelledby="contact-phone">
      <h2 id="contact-phone">Phone</h2>
      <p class="muted">
        <a href={phoneHref}>{site.contact.phone}</a>
      </p>
      <p class="small muted">
        If nobody answers, please leave a message and include a callback number.
      </p>
    </section>

    <section class="card stack--tight" aria-labelledby="contact-email">
      <h2 id="contact-email">Email</h2>
      <p class="muted">
        <a href={`mailto:${site.contact.email}`}>{site.contact.email}</a>
      </p>
    </section>

    <section class="card stack" aria-labelledby="contact-watch-give">
      <h2 id="contact-watch-give">Watch &amp; Give</h2>
      <p class="muted">
        Watch live (when available) or give online.
      </p>

      <div class="cluster">
        <Button href="/media/live" variant="secondary">Watch Live</Button>
        <Button href="/give" variant="ghost">Give</Button>
        {hasYouTube ? (
          <Button href={site.portals.youtubeChannelUrl} external variant="ghost">YouTube</Button>
        ) : null}
        {hasFacebook ? (
          <Button href={site.portals.facebookUrl} external variant="ghost">Facebook</Button>
        ) : null}
      </div>
    </section>

    <section class="card stack" aria-labelledby="contact-form">
      <h2 id="contact-form">Message us</h2>
      {hasContactForm ? (
        <>
          <p class="muted">
            Use our contact form and we’ll follow up as soon as possible.
          </p>
          <Button href={site.portals.contactFormUrl} external variant="secondary">Open contact form</Button>
          <p class="small muted">
            Please avoid including sensitive information.
          </p>
        </>
      ) : (
        <p class="muted">
          A contact form is coming soon. For now, please call or email us.
        </p>
      )}
    </section>
  </div>
</BaseLayout>
</file>

<file path="web/playwright.config.ts">
import { defineConfig, devices } from '@playwright/test';

const HOST = '127.0.0.1';
const PORT = 4321;
const BASE_URL = process.env.PLAYWRIGHT_BASE_URL ?? `http://${HOST}:${PORT}/`;

export default defineConfig({
  testDir: './tests/e2e',
  fullyParallel: true,
  use: {
    baseURL: BASE_URL,
    trace: 'retain-on-failure',
  },
  projects: [
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] },
    },
    {
      name: 'firefox-smoke',
      use: { ...devices['Desktop Firefox'] },
      testMatch: /.*smoke\.spec\.ts/,
    },
    {
      name: 'webkit-smoke',
      use: { ...devices['Desktop Safari'] },
      testMatch: /.*smoke\.spec\.ts/,
    },
    {
      name: 'mobile-smoke',
      use: { ...devices['iPhone 13'] },
      testMatch: /.*smoke\.spec\.ts/,
    },
  ],
  webServer: {
    command: `npm run build && npx wrangler dev --local --ip ${HOST} --port ${PORT} --log-level error`,
    url: BASE_URL,
    timeout: 120 * 1000,
    reuseExistingServer: !process.env.CI,
  },
});
</file>

<file path="web/package.json">
{
  "name": "web",
  "type": "module",
  "version": "0.0.1",
  "private": true,
  "scripts": {
    "dev": "astro dev",
    "start": "astro dev",
    "build": "astro build",
    "preview": "astro preview",
    "check": "astro check",
    "test:e2e": "npm run build && playwright test",
    "test:e2e:ci": "playwright test",
    "test:links": "npm run build && linkinator ./dist --config ./linkinator.config.json",
    "test:links:ci": "linkinator ./dist --config ./linkinator.config.json",
    "lighthouse": "npm run build && lhci autorun --config=./lighthouserc.cjs",
    "lighthouse:ci": "lhci autorun --config=./lighthouserc.cjs",
    "qa": "npm run check && npm run test:e2e && npm run test:links && npm run lighthouse",
    "format": "prettier --write ."
  },
  "dependencies": {
    "@astrojs/check": "0.9.6",
    "@astrojs/cloudflare": "12.6.12",
    "@astrojs/mdx": "^4.3.1",
    "@astrojs/rss": "^4.0.12",
    "@astrojs/sitemap": "^3.5.1",
    "@astrojs/svelte": "^7.0.2",
    "@fontsource-variable/inter": "^5.2.5",
    "astro": "^5.4.2",
    "astro-compress": "^2.3.3",
    "astro-icon": "^1.1.5",
    "astro-pagefind": "^1.7.0",
    "gray-matter": "^4.0.3",
    "sharp": "^0.34.2",
    "svelte": "^5.25.3",
    "zod": "^3.24.2",
    "node-addon-api": "^8.5.0"
  },
  "devDependencies": {
    "@axe-core/playwright": "^4.11.0",
    "@lhci/cli": "^0.15.1",
    "@playwright/test": "^1.51.1",
    "@types/node": "^22.13.9",
    "linkinator": "^7.5.0",
    "prettier": "^3.5.3",
    "prettier-plugin-astro": "^0.14.1",
    "prettier-plugin-svelte": "^3.3.3",
    "typescript": "5.9.3",
    "node-gyp": "^9.4.1"
  }
}
</file>

<file path="web/src/data/site.ts">
export type NavItem = {
  label: string;
  href: string;
  external?: boolean;
};

export type ScheduleItem = {
  label: string;
  day: string;
  time: string;
};

export type PortalLinks = {
  givingUrl: string;
  youtubeChannelUrl: string;
  youtubeLiveEmbedUrl: string;
  facebookUrl: string;
  prayerFormUrl: string;
  contactFormUrl: string;
  volunteerFormUrl: string;
  oldWebsiteUrl: string;
};

export type TeamMember = {
  role: string;
  name: string;
  email?: string;
};

export type ContactTopic = {
  topic: string;
  contactRole: string;
  email?: string;
  href?: string;
  hrefLabel?: string;
  external?: boolean;
  note?: string;
};

// Official public contact details (NAD directory / eAdventist).
// If the church requests different public-facing details, update them here.
const PUBLIC_EMAIL = "firstspringfieldsda@gmail.com";
const PASTOR_NAME = "Pastor Abankwah Amoakohene";

const TIME_ZONE = "America/New_York";

const ADDRESS_LINE = "1118 Sumner Ave, Springfield, MA 01118-2154";
const MAPS_URL =
  "https://www.google.com/maps/dir/?api=1&destination=" + encodeURIComponent(ADDRESS_LINE);

const VISIT_NOTES = {
  directions: [
    "From I-91: take Exit 6 toward Springfield, then follow signs toward Sumner Ave.",
    "From I-90: take Exit 5, follow signs toward Springfield and take Exit 5, then follow local signs to Sumner Ave."
  ],
  languageNote:
    "Services are primarily in English. If you need Spanish support, please contact us and we will help.",
  parkingNote:
    "Street parking is available near the church. Please arrive a few minutes early to find a spot.",
  accessibilityNote:
    "If you need accessibility accommodations, please contact us ahead of time so we can assist."
};

const MISSION = {
  statement:
    "Make disciples of Jesus Christ who live as His loving witnesses and proclaim to all people the everlasting gospel of the Three Angels' Messages in preparation for His soon return (Matt 28:18-20, Acts 1:8, Rev 14:6-12).",
  method:
    "Guided by the Bible and the Holy Spirit, Seventh-day Adventists pursue the mission of making disciples through Christ-like living, healing, serving, proclaiming, teaching, and training.",
  vision:
    "In harmony with Bible revelation, Seventh-day Adventists see as the climax of God's plan the restoration of all His creation to full harmony with His perfect will and righteousness."
};

// Single source of truth for public links + service times
const portals: PortalLinks = {
  // If you have a church-specific AdventistGiving link, replace this.
  givingUrl: "https://adventistgiving.org/",
  youtubeChannelUrl: "https://www.youtube.com/@1stspringfieldsdama74",
  // YouTube live embed: replace with a playlist/embed if the church prefers.
  youtubeLiveEmbedUrl:
    "https://www.youtube.com/embed/live_stream?channel=UCkmryvqlHb3JIwVLc07FZwA",
  // Add the official Facebook page when confirmed.
  facebookUrl: "",
  // Optional forms (set to real URLs when ready)
  prayerFormUrl: "",
  contactFormUrl: "",
  volunteerFormUrl: "",
  // Official AdventistChurchConnect site (currently under construction)
  oldWebsiteUrl: "https://firstspringfieldma.adventistchurch.org/"
};

const weekSchedule: ScheduleItem[] = [
  { label: "Sabbath School", day: "Saturday", time: "10:00 AM" },
  { label: "Worship", day: "Saturday", time: "11:15 AM" },
  { label: "Prayer Meeting", day: "Wednesday", time: "7:00 PM" }
];

const leadershipTeam: TeamMember[] = [
  { role: "Pastor", name: PASTOR_NAME, email: PUBLIC_EMAIL },
  { role: "Head Elder", name: "Church Office", email: PUBLIC_EMAIL },
  { role: "Head Deacon", name: "Church Office", email: PUBLIC_EMAIL },
  { role: "Church Clerk", name: "Church Office", email: PUBLIC_EMAIL },
  { role: "Treasurer", name: "Church Office", email: PUBLIC_EMAIL }
];

const ministryLeads: TeamMember[] = [
  { role: "Children’s Ministry", name: "Children’s Ministry Team", email: PUBLIC_EMAIL },
  { role: "Youth Ministry", name: "Youth Ministry Team", email: PUBLIC_EMAIL },
  { role: "Women’s Ministry", name: "Women’s Ministry Team", email: PUBLIC_EMAIL },
  { role: "Men’s Ministry", name: "Men’s Ministry Team", email: PUBLIC_EMAIL },
  { role: "Communications / Media", name: "Media Team", email: PUBLIC_EMAIL }
];

const hasVolunteerForm = portals.volunteerFormUrl && portals.volunteerFormUrl !== "TBD";
const hasPrayerForm = portals.prayerFormUrl && portals.prayerFormUrl !== "TBD";

const contactTopics: ContactTopic[] = [
  {
    topic: "First-time visit questions",
    contactRole: "Greeter / Hospitality",
    email: PUBLIC_EMAIL,
    note: "Happy to answer questions about parking, what to expect, and children’s programs."
  },
  {
    topic: "Bible study",
    contactRole: "Pastor",
    email: PUBLIC_EMAIL,
    note: "We can connect you with a study group or set up a visit."
  },
  {
    topic: "Prayer Request",
    contactRole: "Prayer Team",
    email: PUBLIC_EMAIL,
    href: hasPrayerForm ? portals.prayerFormUrl : "/connect/contact",
    hrefLabel: hasPrayerForm ? "Open prayer form" : "Contact us",
    external: hasPrayerForm ? true : false
  },
  {
    topic: "Need help choosing a ministry",
    contactRole: "Pastor",
    email: PUBLIC_EMAIL,
    note: "If you are unsure who to contact, start here."
  },
  {
    topic: "Volunteering",
    contactRole: "Ministry Leads",
    email: PUBLIC_EMAIL,
    href: hasVolunteerForm ? portals.volunteerFormUrl : "/connect/contact",
    hrefLabel: hasVolunteerForm ? "Open volunteer form" : "Contact us",
    external: hasVolunteerForm ? true : false
  },
  {
    topic: "Giving questions",
    contactRole: "Treasurer",
    email: PUBLIC_EMAIL,
    href: "/give",
    hrefLabel: "Go to giving page"
  }
];

// Visitor-facing nav (matches real routes and keeps the header feeling “finished”)
const nav: NavItem[] = [
  { label: "Visit", href: "/connect/plan-a-visit" },
  { label: "Contact", href: "/connect/contact" },
  { label: "About Us", href: "/connect/about" },
  { label: "Our Team", href: "/connect/team" },
  { label: "Ministries", href: "/ministries" },
  { label: "Events", href: "/events" },
  { label: "Privacy", href: "/privacy" }
];

// “Always available” actions (show as buttons in the header)
const quickActions: NavItem[] = [
  { label: "Watch Live", href: "/media/live" },
  { label: "Give", href: "/give" },
  { label: "Prayer Request", href: "/connect/prayer" },
  { label: "Bulletins", href: "/resources/bulletins" },
  { label: "Volunteer", href: "/serve" }
];

// Social links used in the legacy footer component
const social: NavItem[] = [];
if (portals.youtubeChannelUrl && portals.youtubeChannelUrl !== "TBD") {
  social.push({ label: "YouTube", href: portals.youtubeChannelUrl, external: true });
}
if (portals.facebookUrl && portals.facebookUrl !== "TBD") {
  social.push({ label: "Facebook", href: portals.facebookUrl, external: true });
}

export const site = {
  name: "First Springfield Seventh-day Adventist Church",
  shortName: "First Springfield SDA",
  locale: "en-US",
  timeZone: TIME_ZONE,
  description:
    "A Seventh-day Adventist church community in Springfield, MA. Join us for worship, Bible study, and service.",
  address: {
    street: "1118 Sumner Ave",
    city: "Springfield",
    state: "MA",
    zip: "01118-2154"
  },
  contact: {
    email: PUBLIC_EMAIL,
    phone: "413-782-6260",
    pastorCell: "(240) 850-9452",
    pastorCellLabel: "Pastor Kobe (call/text)",
    address: ADDRESS_LINE,
    mapsUrl: MAPS_URL,
    // Leave blank unless the church asks for a distinct mailing address.
    mailingAddress: ""
  },

  map: {
    embedSrc:
      "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2961.4635291201326!2d-72.5766111!3d42.1059871!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x3c9b7d2fd5f3b6f2!2sFirst%20Springfield%20Seventh-day%20Adventist%20Church!5e0!3m2!1sen!2sus!4v0000000000000",
    directions: VISIT_NOTES.directions
  },

  visit: VISIT_NOTES,
  mission: MISSION,

  team: {
    leadership: [
      { name: PASTOR_NAME, role: "Pastor", email: PUBLIC_EMAIL },
      { name: "Head Elder", role: "Elder", email: PUBLIC_EMAIL },
      { name: "Church Clerk", role: "Clerk", email: PUBLIC_EMAIL }
    ]
  },

  schedule: weekSchedule,
  portals,

  nav,
  quickActions,

  // Used by the legacy footer component
  social,

  // Team page sections
  leadershipTeam,
  ministryLeads,

  // Contact page topics
  contactTopics
};
</file>

<file path="web/src/pages/index.astro">
---
import BaseLayout from "../layouts/BaseLayout.astro";
import HeroBanner from "../components/sections/HeroBanner.astro";
import CardGrid from "../components/sections/CardGrid.astro";
import EventList from "../components/sections/EventList.astro";
import RecurringActivities from "../components/sections/RecurringActivities.astro";
import SermonHighlight from "../components/sections/SermonHighlight.astro";
import { Image } from "astro:assets";
import { site } from "../data/site";
import heroBg from "../assets/photos/first-springfield-exterior.png";
import bridgeDusk from "../assets/photos/bridge-dusk.jpg";
---

<BaseLayout title={site.name} description={site.description}>
  <HeroBanner
    background={heroBg}
    objectPosition="50% 35%"
    title="Welcome"
    subtitle="A vibrant, multicultural Seventh-day Adventist church in the heart of Springfield, MA."
    primaryCtaLabel="Plan a Visit"
    primaryCtaHref="/connect/plan-a-visit"
    secondaryCtaLabel="Watch Live"
    secondaryCtaHref="/media/live"
  />

  <section class="photo-montage stack">
    <div class="photo-montage__intro">
      <p>
        We gather beneath the morning glow of the new entryway and cherish the calm of the familiar bridge-dusk view.
        Both scenes are part of First Springfield’s story; one bright and ready, the other still and reflective.
      </p>
    </div>

    <div class="photo-montage__grid">
      <article class="photo-card">
        <Image
          src={heroBg}
          alt="First Springfield Church exterior bathed in daylight"
          widths={[440, 660, 880, 1100]}
          sizes="(min-width: 960px) 40vw, 80vw"
          loading="lazy"
          decoding="async"
          class="photo-card__img"
        />
        <div class="photo-card__caption">
          <h3>Sunlit welcome</h3>
          <p>The new front exterior invites you with bright, clear light every day.</p>
        </div>
      </article>

      <article class="photo-card">
        <Image
          src={bridgeDusk}
          alt="The church and bridge illuminated at dusk"
          widths={[440, 660, 880, 1100]}
          sizes="(min-width: 960px) 40vw, 80vw"
          loading="lazy"
          decoding="async"
          class="photo-card__img"
        />
        <div class="photo-card__caption">
          <h3>Evening stillness</h3>
          <p>The bridge-dusk view keeps watch over Springfield as Sabbath approaches.</p>
        </div>
      </article>
    </div>
  </section>

  <CardGrid
    title="Get Connected"
    cards={[
      {
        title: "About Us",
        description: "Learn our mission and what we believe.",
        href: "/connect/about"
      },
      {
        title: "Adult Sabbath School",
        description: "Discover the mission, goals, and study focus of Adult Sabbath School.",
        href: "/ministries/adult-sabbath-school"
      },
      {
        title: "Worship With Us",
        description: "See when we meet and what to expect.",
        href: "/connect/worship-with-us"
      },
      {
        title: "Prayer Request",
        description: "Share a prayer request with our prayer team.",
        href: "/connect/prayer"
      }
    ]}
  />

  <EventList title="Upcoming Events" />

  <RecurringActivities />

  <SermonHighlight title="Latest Sermon" />
</BaseLayout>

<style>
  .photo-montage {
    gap: var(--space-4);
    margin: var(--space-10) 0;
  }

  .photo-montage__intro p {
    margin: 0;
    max-width: 50rem;
    font-size: 1rem;
    color: var(--color-text-muted);
  }

  .photo-montage__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: var(--space-4);
    width: 100%;
  }

  .photo-card {
    border-radius: var(--radius-3);
    border: 1px solid var(--color-border);
    overflow: hidden;
    background: var(--color-surface);
    box-shadow: var(--shadow-2);
    display: flex;
    flex-direction: column;
  }

  .photo-card__img {
    height: 225px;
    width: 100%;
    object-fit: cover;
    display: block;
  }

  .photo-card__caption {
    padding: var(--space-3);
  }

  .photo-card__caption h3 {
    margin: 0 0 0.35rem;
    font-size: 1.1rem;
  }

  .photo-card__caption p {
    margin: 0;
    color: var(--color-text-muted);
  }

  @media (max-width: 720px) {
    .photo-card__img {
      height: 200px;
    }
  }
</style>
</file>

</files>
